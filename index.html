<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git Timeline Visualizer - project_üëç</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', monospace; }
        body { background: linear-gradient(135deg, #0a1929 0%, #1a1a2e 100%); color: #e0e0e0; min-height: 100vh; }
        
        .container {
            display: grid;
            grid-template-columns: 1fr 350px;
            grid-template-rows: auto 1fr auto;
            height: 100vh;
            gap: 15px;
            padding: 20px;
        }
        
        .header {
            grid-column: 1 / -1;
            background: rgba(20, 30, 48, 0.8);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(100, 150, 255, 0.2);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            background: linear-gradient(90deg, #00b4db, #0083b0);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .timeline-area {
            background: rgba(15, 25, 40, 0.8);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(100, 150, 255, 0.2);
            position: relative;
            overflow: hidden;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }
        
        .timeline-container {
            position: relative;
            height: 60vh;
            overflow-y: auto;
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(15, 25, 40, 0.3);
        }
        
        .timeline-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .timeline-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        
        .timeline-container::-webkit-scrollbar-thumb {
            background: rgba(78, 205, 196, 0.5);
            border-radius: 4px;
        }
        
        .timeline-container::-webkit-scrollbar-thumb:hover {
            background: rgba(78, 205, 196, 0.7);
        }
        
        .branch-visualizer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: transform 0.1s ease;
            z-index: 1;
        }
        
        .commit-nodes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: transform 0.1s ease;
            z-index: 2;
        }
        
        .timeline-connections {
            stroke: #4ecdc4;
            stroke-width: 2;
            opacity: 0.6;
        }
        
        .timeline-log-container {
            background: rgba(20, 30, 48, 0.6);
            border-radius: 15px;
            padding: 20px;
            height:44vh;
            overflow-y:scroll;
        }
        
        .timeline-log-container h3 {
            color: #4ecdc4;
            margin: 0 0 20px 0;
            font-size: 1.1rem;
        }
        
        .timeline-log {
            position: relative;
            padding-left: 30px;
        }
        
        .timeline-log::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: rgba(78, 205, 196, 0.3);
        }
        
        .welcome-message {
            text-align: center;
            padding: 20px;
            color: #e0e0e0;
        }
        
        .welcome-title {
            font-size: 18px;
            font-weight: bold;
            color: #4ecdc4;
            margin-bottom: 15px;
            text-shadow: 0 0 10px rgba(78, 205, 196, 0.3);
        }
        
        .welcome-description {
            font-size: 14px;
            color: #b0b0b0;
            margin-bottom: 20px;
        }
        
        .command-example {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 6px;
            padding: 12px;
            margin: 20px 0;
            display: inline-block;
        }
        
        .command-example code {
            color: #4ecdc4;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(78, 205, 196, 0.5);
        }
        
        .welcome-features {
            margin-top: 25px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            text-align: left;
        }
        
        .feature-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            padding: 8px 12px;
            font-size: 12px;
            color: #d0d0d0;
            transition: all 0.3s ease;
        }
        
        .feature-item:hover {
            background: rgba(78, 205, 196, 0.1);
            border-color: rgba(78, 205, 196, 0.3);
            transform: translateY(-2px);
        }
        
        .log-entry {
            position: relative;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            transition: all 0.3s ease;
            margin-left: 20px;
        }
        
        .log-entry:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(78, 205, 196, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .log-entry::before {
            content: '';
            position: absolute;
            left: -23px;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4ecdc4;
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.5);
            z-index: 1;
        }
        
        .log-entry.commit::before {
            background: #51cf66;
            box-shadow: 0 0 10px rgba(81, 207, 102, 0.5);
        }
        
        .log-entry.branch::before {
            background: #ff9ff3;
            box-shadow: 0 0 10px rgba(255, 159, 243, 0.5);
        }
        
        .log-entry.merge::before {
            background: #feca57;
            box-shadow: 0 0 10px rgba(254, 202, 87, 0.5);
        }
        
        .log-entry.remote::before {
            background: #ff6b6b;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }
        
        .log-entry.error::before {
            background: #F44336;
            box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
        }
        
        .log-entry.info::before {
            background: #2196F3;
            box-shadow: 0 0 10px rgba(33, 150, 243, 0.5);
        }
        
        .log-entry.init::before {
            background: #4ecdc4;
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.5);
        }
        
        .log-entry.clone::before {
            background: #48dbfb;
            box-shadow: 0 0 10px rgba(72, 219, 251, 0.5);
        }
        
        .log-entry.pull::before {
            background: #1dd1a1;
            box-shadow: 0 0 10px rgba(29, 209, 161, 0.5);
        }
        
        .log-entry.push::before {
            background: #ff6348;
            box-shadow: 0 0 10px rgba(255, 99, 72, 0.5);
        }
        
        .log-entry.config::before {
            background: #9c27b0;
            box-shadow: 0 0 10px rgba(156, 39, 176, 0.5);
        }
        
        .log-entry.reset::before {
            background: #f44336;
            box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
        }
        
        .log-entry.detach::before {
            background: #ff5722;
            box-shadow: 0 0 10px rgba(255, 87, 34, 0.5);
        }
        
        .log-time {
            font-size: 0.8rem;
            color: #96ceb4;
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .log-command {
            font-size: 0.95rem;
            color: #74c0fc;
            font-family: 'Courier New', monospace;
            font-weight: 500;
            margin-bottom: 8px;
            background: rgba(116, 192, 252, 0.1);
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }
        
        .log-description {
            color: #e0e0e0;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 4px;
        }
        
        .log-description:last-child {
            margin-bottom: 0;
        }
        
        .no-logs {
            text-align: center;
            color: #666;
            padding: 40px 20px;
            font-style: italic;
        }
        
        .commit-nodes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none;
        }
        
        .commit-node {
            position: absolute;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            border: 3px solid #0a1929;
            box-shadow: 0 0 15px rgba(78, 205, 196, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            transform: translate(-50%, -50%);
            z-index: 11;
            pointer-events: auto;
        }
        
        .commit-node.merge {
            background: linear-gradient(135deg, #ff9ff3, #f368e0);
            box-shadow: 0 0 15px rgba(255, 159, 243, 0.5);
        }
        
        .commit-node.branch-commit {
            background: linear-gradient(135deg, #ff6b6b, #ff8e53);
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
        }
        
        .commit-label {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 30, 48, 0.95);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.85rem;
            white-space: nowrap;
            border: 1px solid rgba(100, 150, 255, 0.3);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 12;
            min-width: 200px;
            text-align: center;
        }
        
        .commit-node:hover .commit-label {
            opacity: 1;
        }
        
        .branch-visualizer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5;
        }
        
        .branch-label {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 107, 107, 0.9);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
            white-space: nowrap;
            z-index: 6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .stages-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
            padding: 20px;
            background: rgba(10, 25, 41, 0.6);
            border-radius: 15px;
            /* border: 1px solid rgba(100, 150, 255, 0.2); */
        }
        
        .stage {
            background: rgba(30, 40, 60, 0.6);
            border-radius: 12px;
            padding: 15px;
            min-height: 240px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .stage.active { border-color: #4ecdc4; box-shadow: 0 0 20px rgba(78, 205, 196, 0.3); }
        
        .control-panel {
            background: rgba(20, 30, 48, 0.8);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(100, 150, 255, 0.2);
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-height: 100vh;
            overflow-y: auto;
        }
        
        .command-section h3 {
            color: #4ecdc4;
            margin: 0 0 15px 0;
            font-size: 1.1rem;
            border-bottom: 1px solid rgba(100, 150, 255, 0.3);
            padding-bottom: 8px;
        }
        
        .main-commands {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 6px;
            margin-bottom: 15px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .main-cmd-btn {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(100, 150, 255, 0.3);
            background: rgba(30, 40, 60, 0.6);
            color: #e0e0e0;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .main-cmd-btn:hover {
            background: rgba(78, 205, 196, 0.2);
            border-color: #4ecdc4;
            transform: translateY(-1px);
        }
        
        .main-cmd-btn.active {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            border-color: #4ecdc4;
            color: white;
            box-shadow: 0 2px 10px rgba(78, 205, 196, 0.3);
        }
        
        .auxiliary-commands {
            background: rgba(10, 25, 41, 0.6);
            border-radius: 10px;
            padding: 15px;
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .contextual-help {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
        }
        
        .help-content {
            margin-bottom: 10px;
        }
        
        .help-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            transition: all 0.2s ease;
        }
        
        .help-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(2px);
        }
        
        .help-icon {
            font-size: 16px;
            flex-shrink: 0;
        }
        
        .help-text {
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        .help-text code {
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }
        
        .help-toggle {
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid rgba(78, 205, 196, 0.3);
            color: #4ecdc4;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }
        
        .help-toggle:hover {
            background: rgba(78, 205, 196, 0.3);
            transform: translateY(-1px);
        }
        
        .auxiliary-commands h4 {
            color: #96ceb4;
            margin: 0 0 10px 0;
            font-size: 0.9rem;
        }
        
        .aux-cmd-btn {
            display: block;
            width: 100%;
            padding: 8px 12px;
            margin-bottom: 5px;
            border-radius: 6px;
            border: 1px solid rgba(100, 150, 255, 0.2);
            background: rgba(40, 50, 70, 0.4);
            color: #e0e0e0;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }
        
        .aux-cmd-btn:hover {
            background: rgba(78, 205, 196, 0.15);
            border-color: rgba(78, 205, 196, 0.5);
        }
        
        .graph-control-btn {
            display: block;
            width: 100%;
            padding: 8px 12px;
            margin-bottom: 5px;
            border-radius: 6px;
            border: 1px solid rgba(100, 150, 255, 0.2);
            background: rgba(40, 50, 70, 0.4);
            color: #e0e0e0;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }
        
        .graph-control-btn:hover {
            background: rgba(78, 205, 196, 0.3);
            border-color: rgba(78, 205, 196, 0.5);
            transform: scale(1.05);
        }
        
        .graph-control-btn:active {
            transform: scale(0.95);
        }
        
        .branch-index {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(20, 30, 48, 0.95);
            border: 1px solid rgba(100, 150, 255, 0.3);
            border-radius: 8px;
            padding: 10px;
            min-width: 200px;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }
        
        .branch-index-console {
            background: rgba(20, 30, 48, 0.8);
            border: 1px solid rgba(100, 150, 255, 0.2);
            border-radius: 8px;
            padding: 12px;
            margin-top: 15px;
            backdrop-filter: blur(5px);
        }
        
        .branch-index-animation {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(20, 30, 48, 0.9);
            border: 1px solid rgba(100, 150, 255, 0.3);
            border-radius: 8px;
            padding: 10px;
            min-width: 200px;
            backdrop-filter: blur(10px);
            z-index: 100;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* Documentation Section Styles */
        .documentation-section {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            padding: 60px 20px;
            margin-top: 40px;
            border-top: 2px solid rgba(78, 205, 196, 0.3);
        }
        
        .documentation-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .documentation-title {
            text-align: center;
            font-size: 2.5rem;
            color: #4ecdc4;
            margin-bottom: 50px;
            text-shadow: 0 0 20px rgba(78, 205, 196, 0.5);
            font-weight: 300;
            letter-spacing: 2px;
        }
        
        .command-doc {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .command-doc:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(78, 205, 196, 0.2);
            border-color: rgba(78, 205, 196, 0.3);
        }
        
        .command-title {
            color: #4ecdc4;
            font-size: 1.8rem;
            margin-bottom: 15px;
            font-weight: 400;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .command-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: #4ecdc4;
            border-radius: 2px;
        }
        
        .command-description {
            color: #e0e0e0;
            margin-bottom: 25px;
            line-height: 1.6;
            font-size: 1.1rem;
        }
        
        .command-syntax {
            margin-bottom: 25px;
        }
        
        .command-syntax h4 {
            color: #96ceb4;
            margin-bottom: 10px;
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .command-syntax code {
            background: rgba(0, 0, 0, 0.3);
            color: #ff6b6b;
            padding: 8px 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            display: inline-block;
            margin: 5px 5px 5px 0;
            border: 1px solid rgba(255, 107, 107, 0.3);
        }
        
        .command-examples {
            margin-bottom: 25px;
        }
        
        .command-examples h4 {
            color: #96ceb4;
            margin-bottom: 15px;
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .example {
            background: rgba(0, 0, 0, 0.2);
            border-left: 3px solid #4ecdc4;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 6px 6px 0;
        }
        
        .example code {
            color: #feca57;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            display: block;
            margin-bottom: 8px;
        }
        
        .example p {
            color: #b0b0b0;
            margin: 0;
            font-size: 0.95rem;
        }
        
        .command-diagram {
            margin-bottom: 20px;
        }
        
        .command-diagram h4 {
            color: #96ceb4;
            margin-bottom: 15px;
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        /* Workflow Diagram */
        .workflow-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .workflow-step {
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid rgba(78, 205, 196, 0.3);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .workflow-arrow {
            color: #96ceb4;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        /* Branch Diagram */
        .branch-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            position: relative;
        }
        
        .branch-line {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .branch-commit {
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid rgba(78, 205, 196, 0.3);
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .branch-arrow {
            color: #96ceb4;
            font-size: 1rem;
            font-weight: bold;
        }
        
        .branch-split {
            color: #96ceb4;
            font-size: 2rem;
            font-weight: bold;
            position: absolute;
            left: 50%;
            top: 50%;
        }
        
        .main-branch .branch-commit {
            background: rgba(78, 205, 196, 0.3);
            border-color: rgba(78, 205, 196, 0.5);
        }
        
        .feature-branch .branch-commit {
            background: rgba(254, 202, 87, 0.2);
            border-color: rgba(254, 202, 87, 0.3);
            color: #feca57;
        }
        
        /* Merge Diagram */
        .merge-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .merge-branch {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            justify-content: center;
        }
        
        .merge-label {
            background: rgba(78, 205, 196, 0.3);
            color: #4ecdc4;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            min-width: 60px;
            text-align: center;
        }
        
        .merge-commits {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .merge-commit {
            background: rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .merge-arrow {
            color: #96ceb4;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .merge-result {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        /* Remote Diagram */
        .remote-diagram {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .remote-box {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(78, 205, 196, 0.3);
            border-radius: 8px;
            padding: 20px;
            min-width: 150px;
        }
        
        .remote-label {
            color: #4ecdc4;
            font-weight: 500;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .remote-commits {
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            text-align: center;
        }
        
        .remote-arrows {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .remote-arrow {
            color: #96ceb4;
            font-weight: bold;
            font-size: 0.9rem;
            text-align: center;
        }
        
        /* Config Diagram */
        .config-diagram {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .config-level {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #4ecdc4;
        }
        
        .config-label {
            color: #4ecdc4;
            font-weight: 500;
        }
        
        .config-desc {
            color: #b0b0b0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        /* Log Example */
        .log-example {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .log-entry {
            display: block;
            padding: 5px 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
        
        .log-hash {
            color: #feca57;
            font-weight: bold;
        }
        
        .log-message {
            color: #e0e0e0;
        }
        
        .log-author {
            color: #96ceb4;
        }
        
        .log-date {
            color: #b0b0b0;
        }
        
        /* Reset Diagram */
        .reset-diagram {
            display: flex;
            gap: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .reset-type {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .reset-label {
            color: #4ecdc4;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .reset-desc {
            color: #e0e0e0;
            font-size: 0.9rem;
        }
        
        .reset-warning {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 6px;
            padding: 15px;
            color: #ff6b6b;
            font-size: 0.9rem;
        }
        
        /* Detach Diagram */
        .detach-diagram {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .detach-state {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .detach-label {
            color: #4ecdc4;
            font-weight: 500;
            margin-bottom: 8px;
        }
        
        .detach-flow {
            color: #e0e0e0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .detach-arrow {
            color: #96ceb4;
            font-size: 1.5rem;
            text-align: center;
            font-weight: bold;
        }
        
        .detach-warning {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            border-radius: 6px;
            padding: 15px;
            color: #ff6b6b;
            font-size: 0.9rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .documentation-section {
                padding: 40px 15px;
            }
            
            .documentation-title {
                font-size: 2rem;
            }
            
            .command-doc {
                padding: 20px;
            }
            
            .workflow-diagram {
                flex-direction: column;
                gap: 15px;
            }
            
            .branch-diagram {
                flex-direction: column;
                gap: 15px;
            }
            
            .remote-diagram {
                flex-direction: column;
                gap: 20px;
            }
            
            .remote-arrows {
                flex-direction: row;
                gap: 20px;
            }
            
            .log-entry {
                grid-template-columns: 1fr;
                gap: 5px;
            }
            
            .reset-diagram {
                flex-direction: column;
            }
            
            .merge-diagram {
                gap: 15px;
            }
        }
        
        /* Table of Contents Styles */
        .docs-toc {
            position: sticky;
            top: 20px;
            width: 280px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 25px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            max-height: calc(100vh - 100px);
            overflow-y: auto;
        }
        
        .toc-title {
            color: #4ecdc4;
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: 500;
            text-align: center;
            border-bottom: 2px solid rgba(78, 205, 196, 0.3);
            padding-bottom: 10px;
        }
        
        .toc-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .toc-item {
            margin-bottom: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .toc-item:hover {
            background: rgba(78, 205, 196, 0.1);
            border-left-color: #4ecdc4;
            transform: translateX(5px);
        }
        
        .toc-link {
            display: block;
            color: #e0e0e0;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            margin-bottom: 4px;
            transition: color 0.3s ease;
        }
        
        .toc-link:hover {
            color: #4ecdc4;
        }
        
        .toc-desc {
            color: #96ceb4;
            font-size: 0.8rem;
            font-style: italic;
        }
        
        /* Documentation Layout with TOC */
        .documentation-section {
            display: flex;
            gap: 30px;
            padding: 60px 20px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            margin-top: 40px;
            border-top: 2px solid rgba(78, 205, 196, 0.3);
        }
        
        .documentation-container {
            flex: 1;
            max-width: 900px;
        }
        
        /* Footer Styles */
        .site-footer {
            background: linear-gradient(135deg, #0f3460 0%, #16213e 50%, #1a1a2e 100%);
            border-top: 2px solid rgba(78, 205, 196, 0.3);
            padding: 60px 20px 20px;
            margin-top: 40px;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 30px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .footer-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(78, 205, 196, 0.2);
            border-color: rgba(78, 205, 196, 0.3);
        }
        
        .footer-title {
            color: #4ecdc4;
            font-size: 1.5rem;
            margin-bottom: 20px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .footer-description {
            color: #e0e0e0;
            line-height: 1.6;
            margin-bottom: 25px;
            font-size: 1rem;
        }
        
        .footer-links {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .footer-link {
            color: #96ceb4;
            text-decoration: none;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }
        
        .footer-link:hover {
            color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
            border-color: rgba(78, 205, 196, 0.3);
            transform: translateX(5px);
        }
        
        .learning-path {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .path-step {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border-left: 3px solid #4ecdc4;
        }
        
        .step-number {
            background: #4ecdc4;
            color: #0f3460;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            flex-shrink: 0;
        }
        
        .step-text {
            color: #e0e0e0;
            font-size: 0.95rem;
        }
        
        .footer-quote {
            color: #e0e0e0;
            line-height: 1.6;
            margin-bottom: 25px;
            font-style: italic;
            font-size: 1rem;
            border-left: 3px solid #4ecdc4;
            padding-left: 20px;
        }
        
        .footer-cta {
            text-align: center;
        }
        
        .cta-button {
            display: inline-block;
            color: #0f3460;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a3aa 100%);
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3);
        }
        
        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(78, 205, 196, 0.4);
        }
        
        .footer-bottom {
            text-align: center;
            padding: 20px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .footer-copyright {
            color: #96ceb4;
            font-size: 0.9rem;
            margin: 0;
        }
        
        .footer-copyright a {
            color: #4ecdc4;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-copyright a:hover {
            color: #96ceb4;
        }
        
        /* Responsive Design for Footer and TOC */
        @media (max-width: 1024px) {
            .documentation-section {
                flex-direction: column;
            }
            
            .docs-toc {
                position: static;
                width: 100%;
                max-height: none;
                margin-bottom: 30px;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }
        
        @media (max-width: 768px) {
            .site-footer {
                padding: 40px 15px 15px;
            }
            
            .footer-section {
                padding: 20px;
            }
            
            .footer-title {
                font-size: 1.3rem;
            }
            
            .footer-links {
                gap: 8px;
            }
            
            .footer-link {
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            
            .path-step {
                padding: 10px;
            }
            
            .step-number {
                width: 25px;
                height: 25px;
                font-size: 0.8rem;
            }
            
            .step-text {
                font-size: 0.85rem;
            }
        }
        
        .branch-index-title {
            font-size: 12px;
            font-weight: bold;
            color: #4ecdc4;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .branch-index-content {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .branch-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        
        .branch-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .branch-item.current-branch {
            background: rgba(78, 205, 196, 0.3);
            border: 2px solid rgba(78, 205, 196, 0.6);
            box-shadow: 0 0 15px rgba(78, 205, 196, 0.4);
            transform: scale(1.05);
            position: relative;
        }
        
        .branch-item.current-branch::before {
            content: '‚ñ∂';
            position: absolute;
            left: -8px;
            color: #4ecdc4;
            font-size: 12px;
            animation: pulse 2s infinite;
        }
        
        .branch-item.current-branch .branch-name {
            color: #4ecdc4;
            font-weight: bold;
        }
        
        .branch-item.current-branch .branch-color-box {
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.6);
            transform: scale(1.1);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .branch-color-box {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            flex-shrink: 0;
        }
        
        .branch-name {
            font-size: 12px;
            font-family: monospace;
            font-weight: 500;
            color: #e0e0e0;
        }
        
        .branch-index-number {
            font-size: 10px;
            font-weight: bold;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 4px;
            border-radius: 2px;
            min-width: 12px;
            text-align: center;
        }
        
        /* Dynamic Tips Styles */
        .tip-command {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid rgba(76, 175, 80, 0.4);
            color: #4caf50;
            padding: 4px 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .tip-command:hover {
            background: rgba(76, 175, 80, 0.3);
            border-color: rgba(76, 175, 80, 0.6);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
        }
        
        .tip-command:active {
            transform: translateY(0);
            box-shadow: 0 1px 4px rgba(76, 175, 80, 0.3);
        }
        
        .command-input-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .command-input-container input {
            flex: 1;
            padding: 12px 15px;
            border-radius: 10px;
            border: 1px solid rgba(100, 150, 255, 0.3);
            background: rgba(0, 0, 0, 0.4);
            color: white;
            font-size: 0.9rem;
            font-family: 'Monaco', 'Consolas', monospace;
        }
        
        .execute-btn {
            padding: 12px 20px;
            border-radius: 10px;
            border: none;
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .execute-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(78, 205, 196, 0.4);
        }
        
        .terminal-section {
            border-top: 1px solid rgba(100, 150, 255, 0.2);
            padding-top: 15px;
        }
        
        .terminal-toggle {
            width: 100%;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(100, 150, 255, 0.3);
            background: rgba(30, 40, 60, 0.6);
            color: #e0e0e0;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .terminal-toggle:hover {
            background: rgba(78, 205, 196, 0.2);
            border-color: #4ecdc4;
        }
        
        .terminal {
            grid-column: 1 / -1;
            background: rgba(10, 15, 25, 0.95);
            border-radius: 15px;
            padding: 0;
            border: 1px solid rgba(100, 150, 255, 0.2);
            height: 300px;
            min-height: 150px;
            max-height: 80vh;
            display: flex;
            width: 70vw;
            max-width: 70vw;
            margin: 0 auto;
            flex-direction: column;
            transition: all 0.3s ease;
            transform-origin: top;
            resize: vertical;
            overflow: auto;
        }
        
        .terminal.minimized {
            height: 0;
            opacity: 0;
            margin-bottom: -200px;
            resize: none;
        }
        
        .terminal.expanded {
            height: 400px;
            width: 70vw;
            max-width: 70vw;
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
            resize: both;
            overflow: auto;
        }
        
        .terminal-resize-handle {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, transparent, rgba(78, 205, 196, 0.5), transparent);
            cursor: ns-resize;
            border-radius: 0 0 15px 15px;
        }
        
        .terminal.expanded .terminal-resize-handle {
            cursor: nwse-resize;
        }
        
        .terminal-header {
            background: rgba(20, 30, 48, 0.8);
            padding: 10px 20px;
            border-bottom: 1px solid rgba(100, 150, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .terminal-title {
            color: #4ecdc4;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .terminal-controls {
            display: flex;
            gap: 10px;
        }
        
        .terminal-controls button {
            background: rgba(255, 107, 107, 0.8);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .terminal-controls button:hover {
            background: rgba(255, 107, 107, 1);
        }
        
        .terminal-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        /* Terminal output color coding */
        .terminal-line {
            margin-bottom: 5px;
            word-wrap: break-word;
        }
        
        .terminal-line.command {
            color: #4A90E2; /* Blue for commands */
            font-weight: bold;
        }
        
        .terminal-line.success {
            color: #4CAF50; /* Green for success */
        }
        
        .terminal-line.error {
            color: #F44336; /* Red for errors */
        }
        
        .terminal-line.info {
            color: #FF9800; /* Orange for info */
        }
        
        .terminal-line.warning {
            color: #FFC107; /* Yellow for warnings */
        }
        
        .terminal-input-line {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            border-top: 1px solid rgba(100, 150, 255, 0.2);
            background: rgba(20, 30, 48, 0.6);
        }
        
        .terminal-prompt {
            color: #4ecdc4;
            margin-right: 10px;
            font-family: 'Monaco', 'Consolas', monospace;
        }
        
        .terminal-input {
            flex: 1;
            background: transparent;
            border: none;
            color: white;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9rem;
            outline: none;
        }
        
        /* Storage area styles */
        .file-list {
            list-style: none;
            padding: 10px;
            margin: 0;
            max-height: 180px;
            overflow-y: auto;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            padding: 8px 10px;
            margin-bottom: 5px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border-left: 3px solid #4ecdc4;
            transition: all 0.2s ease;
        }
        
        .file-item:hover {
            background: rgba(78, 205, 196, 0.1);
            transform: translateX(2px);
        }
        
        .file-item i {
            color: #4ecdc4;
            margin-right: 10px;
            font-size: 0.8rem;
        }
        
        .file-name {
            flex: 1;
            font-size: 0.85rem;
            color: #e0e0e0;
        }
        
        .file-message {
            font-size: 0.75rem;
            color: #96ceb4;
            margin-left: 10px;
            font-style: italic;
        }
        
        .file-author {
            font-size: 0.7rem;
            color: #64748b;
            margin-left: 10px;
        }
        
        .empty-stage {
            text-align: center;
            color: #64748b;
            font-style: italic;
            padding: 20px;
            font-size: 0.85rem;
        }
        
        .stage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid rgba(100, 150, 255, 0.2);
        }
        
        .stage-title {
            font-weight: bold;
            color: #e0e0e0;
            font-size: 0.9rem;
        }
        
        .file-count {
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .file-count-mini {
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
            padding: 1px 6px;
            border-radius: 8px;
            font-size: 0.65rem;
            font-weight: bold;
            margin-left: 8px;
        }
        
        .file-name.staged {
            color: #4CAF50;
            font-weight: 500;
        }
        
        .file-name.modified {
            color: #FF9800;
        }
        
        /* Command node styles */
        .command-node {
            position: absolute;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .command-node:hover {
            z-index: 100;
        }
        
        .command-node.selected {
            z-index: 50;
        }
        
        .command-node.selected .command-dot {
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.8);
            border-color: #2a7f7e;
        }
        
        .command-node.selected .command-info {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.1);
        }
        
        .command-node.current-head {
            z-index: 10;
        }
        
        .command-dot {
            width: 16px;
            height: 16px;
            background: #4ecdc4;
            border: 3px solid #2a7f7e;
            border-radius: 50%;
            margin: 0 auto 8px;
            position: relative;
        }
        
        /* Different command type colors */
        .command-init .command-dot { background: #4CAF50; border-color: #2E7D32; }
        .command-add .command-dot { background: #2196F3; border-color: #1565C0; }
        .command-commit .command-dot { background: #FF9800; border-color: #F57C00; }
        .command-branch .command-dot { background: #9C27B0; border-color: #6A1B9A; }
        .command-switch .command-dot { background: #E91E63; border-color: #C2185B; }
        .command-merge .command-dot { background: #00BCD4; border-color: #0097A7; }
        .command-remote .command-dot { background: #795548; border-color: #4E342E; }
        .command-pull .command-dot { background: #607D8B; border-color: #455A64; }
        .command-push .command-dot { background: #FF5722; border-color: #D84315; }
        .command-config .command-dot { background: #FFC107; border-color: #F57F17; }
        .command-log .command-dot { background: #9E9E9E; border-color: #616161; }
        .command-reset .command-dot { background: #F44336; border-color: #C62828; }
        .command-status .command-dot { background: #009688; border-color: #00695C; }
        
        .command-node.current-head .command-dot {
            background: #FFD700;
            border-color: #FFA000;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .command-info {
            background: rgba(10, 15, 25, 0.9);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 8px;
            padding: 8px;
            min-width: 100px;
            font-size: 0.7rem;
            transition: all 0.3s ease;
            opacity: 0.9;
        }
        
        .command-type {
            color: #4ecdc4;
            font-weight: bold;
            font-family: monospace;
            font-size: 0.6rem;
        }
        
        .commit-hash {
            color: #FF9800;
            font-weight: bold;
            font-family: monospace;
        }
        
        .command-message {
            color: #e0e0e0;
            margin: 4px 0;
            font-weight: 500;
            white-space: normal;
            word-wrap: break-word;
            max-width: 100px;
            line-height: 1.2;
        }
        
        .command-text {
            color: #96ceb4;
            font-size: 0.6rem;
            font-family: monospace;
        }
        
        .no-commits {
            text-align: center;
            color: #64748b;
            font-style: italic;
            padding: 40px;
            font-size: 1.1rem;
        }
        
        /* Add more styles from the previous HTML file as needed */
        
        /* Git Graph Visualization Styles */
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.8; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        .git-commit-node {
            font-family: 'Segoe UI', monospace;
        }
        
        .timeline-container {
            position: relative;
            height:40vh;
            overflow-y: auto;
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(15, 25, 40, 0.3);
            min-width: 800px;
        }
        
        .branch-visualizer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: auto;
            cursor: grab;
        }
        
        .branch-visualizer:active {
            cursor: grabbing;
        }
        
        .commit-nodes {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none;
        }
        
        .commit-nodes .git-commit-node {
            pointer-events: auto;
        }
        
        .graph-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 100;
            display: flex;
            gap: 5px;
            background: rgba(20, 30, 48, 0.9);
            padding: 8px;
            border-radius: 8px;
            border: 1px solid rgba(100, 150, 255, 0.2);
        }
        
        .graph-control-btn {
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid rgba(78, 205, 196, 0.3);
            color: #4ecdc4;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }
        
        .graph-control-btn:hover {
            background: rgba(78, 205, 196, 0.3);
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-code-branch"></i> Git Timeline Visualizer</h1>
            <div class="project-info">
                <div class="project-badge">project_üëç</div>
                <div class="git-status" id="git-status">
                    <span id="current-branch">No repository</span>
                    <span id="commit-count"></span>
                </div>
            </div>
        </div>

        <div class="timeline-area">
            <div class="timeline-container">
                <svg class="branch-visualizer" id="branch-visualizer" width="100%" height="100%"></svg>
                <div class="commit-nodes" id="commit-nodes"></div>
                <div class="graph-controls">
                    <button class="graph-control-btn" onclick="zoomIn()">+</button>
                    <button class="graph-control-btn" onclick="zoomOut()">‚àí</button>
                    <button class="graph-control-btn" onclick="resetZoom()">‚ü≤</button>
                    <button class="graph-control-btn" onclick="centerGraph()">‚äô</button>
                </div>
                <!-- Branch Index in Animation Console -->
                <div class="branch-index-animation" id="branch-index">
                    <div class="branch-index-title">üåø Branch Index</div>
                    <div class="branch-index-content" id="branch-index-content"></div>
                </div>
            </div>
            
            <div class="timeline-log-container">
                <h3>üìú Timeline Log</h3>
                <div class="timeline-log" id="timeline-log">
                    <div class="no-logs">No Git commands executed yet.</div>
                </div>
            </div>
            
            <div class="stages-container" style="grid-column: 1 / -1;">
                <div class="stage stage-1" id="stage-working">
                    <div class="stage-header">
                        <div class="stage-title">üìÅ Working Directory</div>
                        <span class="file-count">0</span>
                    </div>
                    <ul class="file-list" id="working-files"></ul>
                </div>
                
                <div class="stage stage-2" id="stage-staging">
                    <div class="stage-header">
                        <div class="stage-title">üì§ Staging Area</div>
                        <span class="file-count">0</span>
                    </div>
                    <ul class="file-list" id="staged-files"></ul>
                </div>
                
                <div class="stage stage-3" id="stage-local">
                    <div class="stage-header">
                        <div class="stage-title">üíæ Local Repository</div>
                        <span class="file-count">0</span>
                    </div>
                    <ul class="file-list" id="committed-files"></ul>
                </div>
                
                <div class="stage stage-4" id="stage-remote">
                    <div class="stage-header">
                        <div class="stage-title">üåê Remote Repository</div>
                        <span class="file-count">0</span>
                    </div>
                    <ul class="file-list" id="remote-files"></ul>
                </div>
            </div>
        </div>

        <div class="control-panel">
            <div class="command-section">
                <h3>Git Commands</h3>
                <div class="main-commands">
                    <button class="main-cmd-btn active" data-cmd="init">git init</button>
                    <button class="main-cmd-btn" data-cmd="add">git add</button>
                    <button class="main-cmd-btn" data-cmd="commit">git commit</button>
                    <button class="main-cmd-btn" data-cmd="branch">git branch</button>
                    <button class="main-cmd-btn" data-cmd="switch">git switch</button>
                    <button class="main-cmd-btn" data-cmd="merge">git merge</button>
                    <button class="main-cmd-btn" data-cmd="remote">git remote</button>
                    <button class="main-cmd-btn" data-cmd="pull">git pull</button>
                    <button class="main-cmd-btn" data-cmd="push">git push</button>
                    <button class="main-cmd-btn" data-cmd="config">git config</button>
                    <button class="main-cmd-btn" data-cmd="log">git log</button>
                    <button class="main-cmd-btn" data-cmd="reset">git reset</button>
                    <button class="main-cmd-btn" data-cmd="clone">git clone</button>
                    <button class="main-cmd-btn" data-cmd="detach">git detach</button>
                </div>
                
                <div class="auxiliary-commands" id="auxiliary-commands">
                    <!-- Contextual Help Panel -->
                    <div class="contextual-help" id="contextual-help">
                        <h4>üí° Smart Help & Hints</h4>
                        <div id="help-content" class="help-content">
                            <div class="help-item">
                                <span class="help-icon">üöÄ</span>
                                <div class="help-text">
                                    <strong>Getting Started:</strong> Initialize your repository with <code>git init</code>
                                </div>
                            </div>
                        </div>
                        <button class="help-toggle" onclick="executeCommand('git init')">git init</button>
                    </div>
                    
                    <!-- Command Suggestions -->
                    <h4>üéØ Suggested Commands</h4>
                    <div id="suggested-commands">
                        <!-- Commands will be populated based on context -->
                    </div>
                </div>
                <!-- <div class="command-input-container">
                    <input type="text" id="git-command" placeholder="Enter Git command..." autocomplete="off">
                    <button class="execute-btn" onclick="executeCommand()">Execute</button>
                </div> -->
            </div>
            
            <div class="terminal-section">
                <button class="terminal-toggle" onclick="toggleTerminal()">
                    <i class="fas fa-terminal"></i> Terminal
                </button>
            </div>
        </div>

        <div class="terminal minimized" id="terminal">
            <div class="terminal-header">
                <div class="terminal-title">üñ•Ô∏è Terminal - project_üëç</div>
                <div class="terminal-controls">
                    <button onclick="clearTerminal()">Clear</button>
                    <button onclick="toggleTerminal()">Minimize</button>
                </div>
            </div>
            <div class="terminal-content" id="terminal-output"></div>
            <div class="terminal-input-line">
                <span class="terminal-prompt" id="terminal-prompt">developer@git-workstation:~/project_üëç$</span>
                <input type="text" class="terminal-input" id="terminal-input" placeholder="Type command here..." autocomplete="off">
            </div>
            <div class="terminal-resize-handle"></div>
        </div>
    </div>

    <!-- Git Commands Documentation Section -->
    <div class="documentation-section">
        <!-- Table of Contents Sidebar -->
        <div class="docs-toc">
            <h3 class="toc-title">üìã Quick Navigation</h3>
            <nav class="toc-nav">
                <ul class="toc-list">
                    <li class="toc-item">
                        <a href="#theory-basics" class="toc-link">‚ö° 2 Mins Theory</a>
                        <span class="toc-desc">Quick Git concepts</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-init" class="toc-link">git init</a>
                        <span class="toc-desc">Initialize repository</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-add" class="toc-link">git add</a>
                        <span class="toc-desc">Stage files</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-commit" class="toc-link">git commit</a>
                        <span class="toc-desc">Save changes</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-branch" class="toc-link">git branch</a>
                        <span class="toc-desc">Manage branches</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-switch" class="toc-link">git switch</a>
                        <span class="toc-desc">Switch branches</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-merge" class="toc-link">git merge</a>
                        <span class="toc-desc">Combine branches</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-remote" class="toc-link">git remote</a>
                        <span class="toc-desc">Manage remotes</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-pull" class="toc-link">git pull</a>
                        <span class="toc-desc">Fetch changes</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-push" class="toc-link">git push</a>
                        <span class="toc-desc">Upload changes</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-config" class="toc-link">git config</a>
                        <span class="toc-desc">Configure Git</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-log" class="toc-link">git log</a>
                        <span class="toc-desc">View history</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-reset" class="toc-link">git reset</a>
                        <span class="toc-desc">Undo changes</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-clone" class="toc-link">git clone</a>
                        <span class="toc-desc">Copy repository</span>
                    </li>
                    <li class="toc-item">
                        <a href="#git-detach" class="toc-link">git detach</a>
                        <span class="toc-desc">Detach HEAD</span>
                    </li>
                </ul>
            </nav>
        </div>
        
        <div class="documentation-container">
            <h2 class="documentation-title">üìö Git Commands Reference</h2>
            
            <div class="docs-intro">
                <p>Quick reference for essential Git commands. Each command includes syntax, common usage, and key points.</p>
            </div>

            <!-- 2 Mins Theory Section -->
            <div class="command-doc" id="theory-basics">
                <h3 class="command-title">‚ö° 2 Mins Theory - Git Core Concepts</h3>
                <p>Essential Git concepts every developer should know in under 2 minutes.</p>
                
                <div class="command-syntax">
                    <strong>üèóÔ∏è Git Architecture - The Three Trees:</strong><br><br>
                    
                    <pre style="background: #1a1a2e; padding: 10px; border-radius: 5px; color: #4ecdc4;">
Working Directory    Staging Area      Repository
     ‚îÇ                   ‚îÇ                   ‚îÇ
     ‚ñº                   ‚ñº                   ‚ñº
  [Your Files]  ‚Üí  [Next Commit]  ‚Üí  [Permanent History]
     ‚îÇ                   ‚îÇ                   ‚îÇ
     ‚îÇ              git add ‚îÇ              git commit
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îÇ
                          ‚îÇ                   ‚îÇ
                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    </pre>
                    
                    <em>Visual Flow:</em> Edit files ‚Üí Stage ‚Üí Commit ‚Üí Save forever
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <strong>üìù What is a Commit? - Time Machine for Your Code:</strong><br><br>
                        
                        <pre style="background: #1a1a2e; padding: 10px; border-radius: 5px; color: #96ceb4;">
Commit Chain (Your Project's Timeline):

A (initial) ‚îÄ‚îÄ‚Üí B (add feature) ‚îÄ‚îÄ‚Üí C (fix bug) ‚îÄ‚îÄ‚Üí D (update docs)
‚îÇ               ‚îÇ                   ‚îÇ                   ‚îÇ
‚îÇ               ‚îÇ                   ‚îÇ                   ‚îÇ
‚ñº               ‚ñº                   ‚ñº                   ‚ñº
üìÅ Project      üìÅ+Feature         üìÅ+Fix             üìÅ+Docs
üë§ Author       üë§+Author          üë§+Author          üë§+Author
üìÖ Time         üìÖ+Time            üìÖ+Time            üìÖ+Time
üìù "init"       üìù "add feature"   üìù "fix bug"       üìù "update docs"
üÜî abc123       üÜî def456           üÜî ghi789           üÜî jkl012
                        </pre>
                        
                        <em>Each commit = Complete snapshot + Metadata</em>
                    </div>
                    <div class="example">
                        <strong>üéØ HEAD - Git's "You Are Here" Pointer:</strong><br><br>
                        
                        <pre style="background: #1a1a2e; padding: 10px; border-radius: 5px; color: #9c27b0;">
HEAD BASICS:

HEAD is a pointer that says "you are here"

Normal State (on branch):
HEAD ‚Üí main ‚Üí A ‚Üí B ‚Üí C
       ‚îÇ
       ‚îî‚îÄ‚îÄ Current branch pointer

Detached State (on commit):
HEAD ‚Üí C (directly pointing to commit)
       ‚îÇ
       ‚îî‚îÄ‚îÄ No branch pointer


HEAD MOVEMENT:

1. git checkout main
   HEAD ‚Üí main ‚Üí A ‚Üí B ‚Üí C

2. git checkout feature  
   HEAD ‚Üí feature ‚Üí D ‚Üí E

3. git checkout abc123 (commit hash)
   HEAD ‚Üí abc123 (DETACHED!)

4. git switch -c new-feature (from detached)
   HEAD ‚Üí new-feature ‚Üí abc123
                        </pre>
                        
                        <em>HEAD = Your current position in Git history</em>
                    </div>
                    <div class="example">
                        <strong>üö® Detached HEAD - The Danger Zone:</strong><br><br>
                        
                        <pre style="background: #1a1a2e; padding: 10px; border-radius: 5px; color: #ff5722;">
DETACHED HEAD SCENARIOS:

‚ùå How to get into detached HEAD:
1. git checkout abc123 (commit hash)
2. git checkout HEAD~3 (go back 3 commits)
3. git tag v1.0; git checkout v1.0

‚ö†Ô∏è What happens in detached HEAD:
HEAD ‚Üí abc123
       ‚îÇ
       ‚îî‚îÄ‚îÄ No branch tracking commits!

üìù New commits here:
HEAD ‚Üí abc123 ‚Üí NEW1 ‚Üí NEW2
       ‚îÇ
       ‚îî‚îÄ‚îÄ These commits can be LOST!

‚úÖ How to recover/exiting:

Option 1: Create branch (SAFE)
git switch -c save-my-work
Result: save-my-work ‚Üí abc123 ‚Üí NEW1 ‚Üí NEW2

Option 2: Go back to branch (LOSES WORK)
git checkout main
Result: NEW1 and NEW2 are abandoned!

Option 3: Use reflog (RECOVERY)
git reflog
git checkout -b save-work HEAD@{2}
                        </pre>
                        
                        <em>üö® Rule: Never work in detached HEAD without creating a branch!</em>
                    </div>
                    <div class="example">
                        <strong>üîÑ Merge vs Rebase - Visual Comparison:</strong><br><br>
                        
                        <pre style="background: #1a1a2e; padding: 10px; border-radius: 5px; color: #2196f3;">
MERGE (Preserves History):

main:     A ‚îÄ‚îÄ‚Üí B ‚îÄ‚îÄ‚Üí C ‚îÄ‚îÄ‚Üí F
               ‚îÇ           ‚Üó ‚Üë
feature:       ‚îî‚îÄ‚îÄ‚Üí D ‚îÄ‚îÄ‚Üí E ‚îò

Result: Diamond shape, complete history preserved


REBASE (Linear History):

Before:          After:
main:  A‚îÄB‚îÄC         A‚îÄB‚îÄC‚îÄD'‚îÄE'‚îÄF
feature:   ‚îî‚îÄD‚îÄE

Result: Straight line, rewritten history
                        </pre>
                        
                        <em>üö® Golden Rule: Never rebase shared branches!</em>
                    </div>
                    <div class="example">
                        <strong>üö® Safety Nets - Git's Emergency Tools:</strong><br><br>
                        
                        <pre style="background: #1a1a2e; padding: 10px; border-radius: 5px; color: #f44336;">
REFLOG (Your Safety Net):

HEAD@{0}: commit: abc123 (latest)
HEAD@{1}: commit: def456 
HEAD@{2}: reset: moving to HEAD~1
HEAD@{3}: commit: ghi789
HEAD@{4}: checkout: moving to feature

‚§¥Ô∏è Can jump back to any point!


STASH (Temporary Pocket):

Working: [dirty files] ‚îÄ‚îÄ‚Üí git stash ‚îÄ‚îÄ‚Üí [clean directory]
                                      ‚îÇ
                                      ‚Üì
                              [saved in pocket]
                                      ‚îÇ
                                      ‚Üì
                              git stash pop ‚îÄ‚îÄ‚Üí [restore files]
                        </pre>
                        
                        <em>Reflog = Time machine, Stash = Temporary storage</em>
                    </div>
                    <div class="example">
                        <strong>üåê Remote Workflows - Team Collaboration:</strong><br><br>
                        
                        <pre style="background: #1a1a2e; padding: 10px; border-radius: 5px; color: #00bcd4;">
TEAM WORKFLOW:

Remote Repo    Local Repo    Your Work
    ‚îÇ              ‚îÇ             ‚îÇ
    ‚îÇ git fetch    ‚îÇ             ‚îÇ
    ‚Üì‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ             ‚îÇ
    ‚îÇ              ‚îÇ             ‚îÇ
    ‚îÇ              ‚îÇ git pull    ‚îÇ
    ‚îÇ              ‚Üì‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ
    ‚îÇ              ‚îÇ             ‚îÇ
    ‚îÇ              ‚îÇ             ‚ñº
    ‚îÇ              ‚îÇ        [Edit files]
    ‚îÇ              ‚îÇ             ‚îÇ
    ‚îÇ              ‚îÇ git commit  ‚îÇ
    ‚îÇ              ‚îÇ             ‚ñº
    ‚îÇ              ‚îÇ        [New commit]
    ‚îÇ              ‚îÇ             ‚îÇ
    ‚îÇ git push     ‚îÇ             ‚îÇ
    ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§             ‚îÇ
    ‚îÇ              ‚îÇ             ‚îÇ

Cycle: Pull ‚Üí Work ‚Üí Commit ‚Üí Push ‚Üí Repeat
                        </pre>
                    </div>
                    <div class="example">
                        <strong>‚ö° Pro Tips - Git Best Practices:</strong><br><br>
                        
                        <div id="dynamic-tips" style="background: #1a1a2e; padding: 10px; border-radius: 5px; color: #4caf50;">
                            <div id="tip-content">
                                <div style="margin-bottom: 15px;">
                                    <strong>üéØ Interactive Commands:</strong> Click any command to copy it to input!
                                </div>
                                
                                <div style="margin-bottom: 10px;">
                                    <strong>üìù Common Commands:</strong>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 15px;">
                                    <button class="tip-command" onclick="executeTipCommand('git status')">git status</button>
                                    <button class="tip-command" onclick="executeTipCommand('git log --oneline')">git log --oneline</button>
                                    <button class="tip-command" onclick="executeTipCommand('git add .')">git add .</button>
                                    <button class="tip-command" onclick="executeTipCommand('git diff')">git diff</button>
                                    <button class="tip-command" onclick="executeTipCommand('git branch')">git branch</button>
                                </div>
                                
                                <div style="margin-bottom: 10px;">
                                    <strong>üåø Branch Operations:</strong>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 15px;">
                                    <button class="tip-command" onclick="executeTipCommand('git branch feature')">git branch feature</button>
                                    <button class="tip-command" onclick="executeTipCommand('git switch feature')">git switch feature</button>
                                    <button class="tip-command" onclick="executeTipCommand('git switch main')">git switch main</button>
                                    <button class="tip-command" onclick="executeTipCommand('git merge feature')">git merge feature</button>
                                </div>
                                
                                <div style="margin-bottom: 10px;">
                                    <strong>üö® Safety Commands:</strong>
                                </div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 15px;">
                                    <button class="tip-command" onclick="executeTipCommand('git reflog')">git reflog</button>
                                    <button class="tip-command" onclick="executeTipCommand('git stash')">git stash</button>
                                    <button class="tip-command" onclick="executeTipCommand('git stash pop')">git stash pop</button>
                                    <button class="tip-command" onclick="executeTipCommand('git reset --soft HEAD~1')">git reset --soft HEAD~1</button>
                                </div>
                                
                                <div style="margin-bottom: 10px;">
                                    <strong>üí° Current Tip:</strong>
                                </div>
                                <div id="rotating-tip" style="padding: 8px; background: rgba(76, 175, 80, 0.1); border-left: 3px solid #4caf50; border-radius: 3px;">
                                    <!-- Tips will rotate here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Git Init -->
            <div class="command-doc" id="git-init">
                <h3 class="command-title">git init</h3>
                <p>Initialize a new Git repository in the current directory.</p>
                
                <div class="command-syntax">
                    <code>git init</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git init</code>
                        <p>Create repository in current directory</p>
                    </div>
                </div>
            </div>

            <!-- Git Add -->
            <div class="command-doc" id="git-add">
                <h3 class="command-title">git add</h3>
                <p>Stage files for the next commit.</p>
                
                <div class="command-syntax">
                    <code>git add &lt;file&gt;</code><br>
                    <code>git add .</code><br>
                    <code>git add *.ext</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git add app.js</code>
                        <p>Stage specific file</p>
                    </div>
                    <div class="example">
                        <code>git add .</code>
                        <p>Stage all files</p>
                    </div>
                </div>
            </div>

            <!-- Git Commit -->
            <div class="command-doc" id="git-commit">
                <h3 class="command-title">git commit</h3>
                <p>Save staged changes with a descriptive message.</p>
                
                <div class="command-syntax">
                    <code>git commit -m "&lt;message&gt;"</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git commit -m "Add user authentication"</code>
                        <p>Commit with message</p>
                    </div>
                    <div class="example">
                        <code>git commit -m "Fix login bug"</code>
                        <p>Commit bug fix</p>
                    </div>
                </div>
            </div>

            <!-- Git Branch -->
            <div class="command-doc" id="git-branch">
                <h3 class="command-title">git branch</h3>
                <p>Create, list, rename, or delete branches.</p>
                
                <div class="command-syntax">
                    <code>git branch</code><br>
                    <code>git branch &lt;name&gt;</code><br>
                    <code>git branch -d &lt;name&gt;</code><br>
                    <code>git branch -m &lt;old&gt; &lt;new&gt;</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git branch</code>
                        <p>List all branches</p>
                    </div>
                    <div class="example">
                        <code>git branch feature</code>
                        <p>Create new branch</p>
                    </div>
                    <div class="example">
                        <code>git branch -d old-feature</code>
                        <p>Delete branch</p>
                    </div>
                </div>
            </div>

            <!-- Git Switch -->
            <div class="command-doc" id="git-switch">
                <h3 class="command-title">git switch</h3>
                <p>Switch between branches or create and switch to new branch.</p>
                
                <div class="command-syntax">
                    <code>git switch &lt;branch&gt;</code><br>
                    <code>git switch -c &lt;new-branch&gt;</code><br>
                    <code>git switch -</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git switch main</code>
                        <p>Switch to main branch</p>
                    </div>
                    <div class="example">
                        <code>git switch -c feature</code>
                        <p>Create and switch to new branch</p>
                    </div>
                    <div class="example">
                        <code>git switch -</code>
                        <p>Switch to previous branch</p>
                    </div>
                </div>
            </div>

            <!-- Git Merge -->
            <div class="command-doc" id="git-merge">
                <h3 class="command-title">git merge</h3>
                <p>Join branches together.</p>
                
                <div class="command-syntax">
                    <code>git merge &lt;branch&gt;</code><br>
                    <code>git merge --abort</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git merge feature</code>
                        <p>Merge feature into current branch</p>
                    </div>
                    <div class="example">
                        <code>git merge --abort</code>
                        <p>Abort merge in progress</p>
                    </div>
                </div>
            </div>

            <!-- Git Remote -->
            <div class="command-doc" id="git-remote">
                <h3 class="command-title">git remote</h3>
                <p>Manage remote repositories.</p>
                
                <div class="command-syntax">
                    <code>git remote -v</code><br>
                    <code>git remote add &lt;name&gt; &lt;url&gt;</code><br>
                    <code>git remote remove &lt;name&gt;</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git remote -v</code>
                        <p>List all remotes</p>
                    </div>
                    <div class="example">
                        <code>git remote add origin https://github.com/user/repo.git</code>
                        <p>Add remote repository</p>
                    </div>
                </div>
            </div>

            <!-- Git Pull -->
            <div class="command-doc" id="git-pull">
                <h3 class="command-title">git pull</h3>
                <p>Fetch and integrate changes from remote repository.</p>
                
                <div class="command-syntax">
                    <code>git pull</code><br>
                    <code>git pull &lt;remote&gt; &lt;branch&gt;</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git pull</code>
                        <p>Pull from default remote</p>
                    </div>
                    <div class="example">
                        <code>git pull origin main</code>
                        <p>Pull main branch from origin</p>
                    </div>
                </div>
            </div>

            <!-- Git Push -->
            <div class="command-doc" id="git-push">
                <h3 class="command-title">git push</h3>
                <p>Upload local commits to remote repository.</p>
                
                <div class="command-syntax">
                    <code>git push</code><br>
                    <code>git push &lt;remote&gt; &lt;branch&gt;</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git push</code>
                        <p>Push to default remote</p>
                    </div>
                    <div class="example">
                        <code>git push origin main</code>
                        <p>Push main branch to origin</p>
                    </div>
                </div>
            </div>

            <!-- Git Config -->
            <div class="command-doc" id="git-config">
                <h3 class="command-title">git config</h3>
                <p>Set configuration options.</p>
                
                <div class="command-syntax">
                    <code>git config --global user.name "&lt;name&gt;"</code><br>
                    <code>git config --global user.email "&lt;email&gt;"</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git config --global user.name "John Doe"</code>
                        <p>Set user name</p>
                    </div>
                    <div class="example">
                        <code>git config --global user.email "john@example.com"</code>
                        <p>Set user email</p>
                    </div>
                </div>
            </div>

            <!-- Git Log -->
            <div class="command-doc" id="git-log">
                <h3 class="command-title">git log</h3>
                <p>Show commit history.</p>
                
                <div class="command-syntax">
                    <code>git log</code><br>
                    <code>git log --oneline</code><br>
                    <code>git log -n &lt;number&gt;</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git log</code>
                        <p>Show detailed history</p>
                    </div>
                    <div class="example">
                        <code>git log --oneline</code>
                        <p>Show compact history</p>
                    </div>
                    <div class="example">
                        <code>git log -n 5</code>
                        <p>Show last 5 commits</p>
                    </div>
                </div>
            </div>

            <!-- Git Reset -->
            <div class="command-doc" id="git-reset">
                <h3 class="command-title">git reset</h3>
                <p>Reset HEAD to specified state.</p>
                
                <div class="command-syntax">
                    <code>git reset --soft HEAD~1</code><br>
                    <code>git reset HEAD~1</code><br>
                    <code>git reset --hard HEAD~1</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git reset --soft HEAD~1</code>
                        <p>Reset but keep changes staged</p>
                    </div>
                    <div class="example">
                        <code>git reset HEAD~1</code>
                        <p>Reset and unstage changes</p>
                    </div>
                    <div class="example">
                        <code>git reset --hard HEAD~1</code>
                        <p>Reset and discard all changes</p>
                    </div>
                </div>
            </div>

            <!-- Git Clone -->
            <div class="command-doc" id="git-clone">
                <h3 class="command-title">git clone</h3>
                <p>Clone a repository into new directory.</p>
                
                <div class="command-syntax">
                    <code>git clone &lt;url&gt;</code><br>
                    <code>git clone &lt;url&gt; &lt;directory&gt;</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git clone https://github.com/user/repo.git</code>
                        <p>Clone repository</p>
                    </div>
                    <div class="example">
                        <code>git clone https://github.com/user/repo.git my-project</code>
                        <p>Clone into specific directory</p>
                    </div>
                </div>
            </div>

            <!-- Git Detach -->
            <div class="command-doc" id="git-detach">
                <h3 class="command-title">git detach</h3>
                <p>Detach HEAD to point directly to commit.</p>
                
                <div class="command-syntax">
                    <code>git detach</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git detach</code>
                        <p>Detach HEAD to current commit</p>
                    </div>
                </div>
            </div>

            <!-- Intermediate Git Concepts -->
            <div class="command-doc" id="how-git-works">
                <h3 class="command-title">üèóÔ∏è How Git Works Internally</h3>
                <p>Understanding Git's repository system and internal mechanics.</p>
                
                <div class="command-syntax">
                    <strong>Repository Structure:</strong><br>
                    ‚Ä¢ <code>.git/objects/</code> - All commits, trees, blobs (content-addressable storage)<br>
                    ‚Ä¢ <code>.git/refs/</code> - Branch references and tags<br>
                    ‚Ä¢ <code>.git/HEAD</code> - Current branch pointer<br>
                    ‚Ä¢ <code>.git/index</code> - Staging area
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <strong>Content-Addressable Storage:</strong><br>
                        Every object stored by SHA-1 hash of its content<br>
                        Commits reference tree objects ‚Üí trees reference blobs
                    </div>
                    <div class="example">
                        <strong>Three Trees:</strong><br>
                        ‚Ä¢ Working Directory ‚Üí Staging Area ‚Üí Repository<br>
                        ‚Ä¢ <code>git add</code> moves changes to staging<br>
                        ‚Ä¢ <code>git commit</code> moves staging to repository
                    </div>
                    <div class="example">
                        <strong>References:</strong><br>
                        ‚Ä¢ Branch names are just text files containing commit SHAs<br>
                        ‚Ä¢ HEAD points to current branch reference<br>
                        ‚Ä¢ Tags are immutable references
                    </div>
                </div>
            </div>

            <div class="command-doc" id="head-and-detached">
                <h3 class="command-title">üéØ HEAD & Detached State</h3>
                <p>Understanding Git's HEAD pointer and detached HEAD scenarios.</p>
                
                <div class="command-syntax">
                    <strong>Normal State:</strong><br>
                    HEAD ‚Üí branch-name ‚Üí commit-SHA<br><br>
                    <strong>Detached State:</strong><br>
                    HEAD ‚Üí commit-SHA (no branch)
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git checkout commit-hash</code>
                        <p>Enter detached HEAD state</p>
                    </div>
                    <div class="example">
                        <code>git switch main</code>
                        <p>Exit detached state (creates no new commits)</p>
                    </div>
                    <div class="example">
                        <code>git switch -c new-branch</code>
                        <p>Create branch from detached commit</p>
                    </div>
                    <div class="example">
                        <strong>‚ö†Ô∏è Risks:</strong><br>
                        ‚Ä¢ Commits in detached state can be lost<br>
                        ‚Ä¢ No automatic branch tracking<br>
                        ‚Ä¢ Use reflog to recover lost commits
                    </div>
                </div>
            </div>

            <div class="command-doc" id="staging-area">
                <h3 class="command-title">üìã Staging Area & Index</h3>
                <p>Understanding Git's staging area and selective staging techniques.</p>
                
                <div class="command-syntax">
                    <code>git add -p</code><br>
                    <code>git add --patch</code><br>
                    <code>git reset HEAD -- file</code><br>
                    <code>git restore --staged file</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git add -p</code>
                        <p>Interactive staging - choose specific hunks</p>
                    </div>
                    <div class="example">
                        <code>git add -e</code>
                        <p>Edit patches manually before staging</p>
                    </div>
                    <div class="example">
                        <code>git diff --cached</code>
                        <p>View staged changes only</p>
                    </div>
                    <div class="example">
                        <strong>Workflow Benefits:</strong><br>
                        ‚Ä¢ Review changes before committing<br>
                        ‚Ä¢ Split logical changes into separate commits<br>
                        ‚Ä¢ Create clean, atomic commits
                    </div>
                </div>
            </div>

            <div class="command-doc" id="merge-vs-rebase">
                <h3 class="command-title">üîÄ Merge vs Rebase</h3>
                <p>Understanding integration strategies and when to use each.</p>
                
                <div class="command-syntax">
                    <code>git merge feature</code><br>
                    <code>git rebase main</code><br>
                    <code>git rebase -i HEAD~3</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <strong>Merge:</strong><br>
                        ‚Ä¢ Creates merge commit<br>
                        ‚Ä¢ Preserves complete history<br>
                        ‚Ä¢ Safe for shared branches<br>
                        ‚Ä¢ Use: merging feature ‚Üí main
                    </div>
                    <div class="example">
                        <strong>Rebase:</strong><br>
                        ‚Ä¢ Linear history<br>
                        ‚Ä¢ Rewrites commit history<br>
                        ‚Ä¢ Don't use on shared branches<br>
                        ‚Ä¢ Use: updating feature branch
                    </div>
                    <div class="example">
                        <code>git rebase -i</code>
                        <p>Interactive rebase: squash, reorder, edit commits</p>
                    </div>
                    <div class="example">
                        <strong>Golden Rule:</strong><br>
                        Never rebase branches that others use
                    </div>
                </div>
            </div>

            <div class="command-doc" id="reset-modes">
                <h3 class="command-title">‚Ü©Ô∏è Reset Modes</h3>
                <p>Understanding git reset's three modes and their use cases.</p>
                
                <div class="command-syntax">
                    <code>git reset --soft HEAD~1</code><br>
                    <code>git reset --mixed HEAD~1</code><br>
                    <code>git reset --hard HEAD~1</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git reset --soft HEAD~1</code>
                        <p>Undo commit but keep changes staged</p>
                        <small>Use: fix last commit message</small>
                    </div>
                    <div class="example">
                        <code>git reset --mixed HEAD~1</code>
                        <p>Undo commit and unstage changes</p>
                        <small>Use: completely redo last commit</small>
                    </div>
                    <div class="example">
                        <code>git reset --hard HEAD~1</code>
                        <p>Discard all changes completely</p>
                        <small>Use: abandon work, dangerous!</small>
                    </div>
                    <div class="example">
                        <strong>Comparison Table:</strong><br>
                        | Mode | Working Dir | Staging | Repository |<br>
                        |------|-------------|---------|------------|<br>
                        | --soft | unchanged | unchanged | moved |<br>
                        | --mixed | unchanged | changed | moved |<br>
                        | --hard | changed | changed | moved |
                    </div>
                </div>
            </div>

            <div class="command-doc" id="reflog-recovery">
                <h3 class="command-title">üï∞Ô∏è Reflog & Recovery</h3>
                <p>Git's safety net for recovering lost commits and operations.</p>
                
                <div class="command-syntax">
                    <code>git reflog</code><br>
                    <code>git reflog --oneline</code><br>
                    <code>git reset --hard HEAD@{2}</code><br>
                    <code>git cherry-pick HEAD@{1}</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git reflog</code>
                        <p>Show all local operations history</p>
                    </div>
                    <div class="example">
                        <code>git reset --hard HEAD@{5}</code>
                        <p>Recover to state 5 operations ago</p>
                    </div>
                    <div class="example">
                        <strong>Recovery Scenarios:</strong><br>
                        ‚Ä¢ Accidentally deleted branch<br>
                        ‚Ä¢ Wrong reset --hard<br>
                        ‚Ä¢ Lost commits in detached HEAD<br>
                        ‚Ä¢ Failed rebase/merge
                    </div>
                    <div class="example">
                        <strong>‚ö†Ô∏è Limitations:</strong><br>
                        ‚Ä¢ Local only (doesn't sync)<br>
                        ‚Ä¢ Expires after ~90 days<br>
                        ‚Ä¢ Not a backup solution
                    </div>
                </div>
            </div>

            <div class="command-doc" id="remote-workflows">
                <h3 class="command-title">üåê Remote Workflows</h3>
                <p>Understanding remote operations and collaboration workflows.</p>
                
                <div class="command-syntax">
                    <code>git fetch</code><br>
                    <code>git pull</code><br>
                    <code>git push --force-with-lease</code><br>
                    <code>git branch -u origin/main</code>
                </div>
                
                <div class="command-examples">
                    <div class="example">
                        <code>git fetch</code>
                        <p>Download remote changes without merging</p>
                        <small>Safe: review before integrating</small>
                    </div>
                    <div class="example">
                        <code>git pull</code>
                        <p>Fetch + merge/rebase automatically</p>
                        <small>Convenient: less control</small>
                    </div>
                    <div class="example">
                        <code>git push --force-with-lease</code>
                        <p>Safe force push: checks if remote changed</p>
                    </div>
                    <div class="example">
                        <strong>Tracking Branches:</strong><br>
                        ‚Ä¢ <code>git branch -u origin/feature</code> - set upstream<br>
                        ‚Ä¢ <code>git push</code> pushes to upstream<br>
                        ‚Ä¢ <code>git pull</code> pulls from upstream<br>
                        ‚Ä¢ <code>git branch --set-upstream-to</code> alternative
                    </div>
                    <div class="example">
                        <strong>Best Practices:</strong><br>
                        ‚Ä¢ Pull before pushing<br>
                        ‚Ä¢ Use fetch for safety<br>
                        ‚Ä¢ Never force push main/master<br>
                        ‚Ä¢ Protect important branches
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Section -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3 class="footer-title">üå± Git Beginner Resources</h3>
                <p class="footer-description">
                    This interactive Git Timeline Visualizer is designed to help you understand Git version control through hands-on learning. 
                    Don't let curiosity limit your exploration of Git's powerful capabilities!
                </p>
                <div class="footer-links">
                    <a href="https://git-scm.com/doc" target="_blank" rel="noopener noreferrer" class="footer-link">
                        üìö Official Git Documentation
                    </a>
                    <a href="https://git-scm.com/book" target="_blank" rel="noopener noreferrer" class="footer-link">
                        üìñ Pro Git Book
                    </a>
                    <a href="https://github.com/git/git" target="_blank" rel="noopener noreferrer" class="footer-link">
                        üîß Git Source Code
                    </a>
                    <a href="https://git-scm.com/docs/gittutorial" target="_blank" rel="noopener noreferrer" class="footer-link">
                        üéì Git Tutorial
                    </a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3 class="footer-title">üí° Learning Path</h3>
                <div class="learning-path">
                    <div class="path-step">
                        <span class="step-number">1</span>
                        <span class="step-text">Start with basic commands (init, add, commit)</span>
                    </div>
                    <div class="path-step">
                        <span class="step-number">2</span>
                        <span class="step-text">Explore branching and merging</span>
                    </div>
                    <div class="path-step">
                        <span class="step-number">3</span>
                        <span class="step-text">Learn remote operations</span>
                    </div>
                    <div class="path-step">
                        <span class="step-number">4</span>
                        <span class="step-text">Master advanced workflows</span>
                    </div>
                </div>
            </div>
            
            <div class="footer-section">
                <h3 class="footer-title">üöÄ Continue Your Journey</h3>
                <p class="footer-quote">
                    "Git is not just a tool, it's a way of thinking about version control. 
                    Keep exploring, keep learning, and don't be afraid to experiment!"
                </p>
                <div class="footer-cta">
                    <a href="https://git-scm.com/community" target="_blank" rel="noopener noreferrer" class="cta-button">
                        Join Git Community
                    </a>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p class="footer-copyright">
                Made with ‚ù§Ô∏è for Git learners everywhere | 
                <a href="https://git-scm.com" target="_blank" rel="noopener noreferrer">git-scm.com</a>
            </p>
        </div>
    </footer>

    <!-- Import browser-compatible core modules -->
    <script src="git-timeline-browser.js"></script>
    <script src="git-command-processor-browser.js"></script>
    
    <script>
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Create Git command processor
            const gitProcessor = new GitCommandProcessor();
            
            // Make available globally
            window.gitProcessor = gitProcessor;
            
            // Initialize event listeners
            initializeEventListeners();
            
            // Add welcome message to terminal
            gitProcessor.addTerminalOutput('üöÄ Welcome to Git Timeline Visualizer!', 'info');
            gitProcessor.addTerminalOutput('', 'info');
            gitProcessor.addTerminalOutput('Start by initializing a Git repository:', 'info');
            gitProcessor.addTerminalOutput('  git init', 'success');
            gitProcessor.addTerminalOutput('', 'info');
            gitProcessor.addTerminalOutput('Features available:', 'info');
            gitProcessor.addTerminalOutput('  üåø Create and switch branches', 'info');
            gitProcessor.addTerminalOutput('  üìù Make commits and track changes', 'info');
            gitProcessor.addTerminalOutput('  üîÑ Visualize branch operations', 'info');
            gitProcessor.addTerminalOutput('  üìä See real-time timeline updates', 'info');
            gitProcessor.addTerminalOutput('', 'info');
            gitProcessor.addTerminalOutput('Type "git init" to begin...', 'success');
            updateTerminal();
            
            // Initialize storage areas
            updateStorageAreas();
            
            // Initialize branch index
            updateBranchIndex();
            
            // Initialize git status display
            updateGitStatusDisplay();
            
            // Initialize TOC functionality
            initializeTOC();
            
            // Initialize rotating tips
            initializeRotatingTips();
        });
        
        // Table of Contents functionality
        function initializeTOC() {
            // Add smooth scrolling to all TOC links
            const tocLinks = document.querySelectorAll('.toc-link');
            tocLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    
                    if (targetElement) {
                        // Smooth scroll to target
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                        
                        // Update active state
                        updateActiveTOCItem(targetId);
                    }
                });
            });
            
            // Update active TOC item on scroll
            const observerOptions = {
                root: null,
                rootMargin: '-20% 0px -70% 0px',
                threshold: 0
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.id;
                        if (id && id.startsWith('git-')) {
                            updateActiveTOCItem(id);
                        }
                    }
                });
            }, observerOptions);
            
            // Observe all command documentation sections
            const commandDocs = document.querySelectorAll('.command-doc[id^="git-"]');
            commandDocs.forEach(doc => observer.observe(doc));
        }
        
        function updateActiveTOCItem(activeId) {
            // Remove active class from all TOC items
            const tocItems = document.querySelectorAll('.toc-item');
            tocItems.forEach(item => {
                item.style.background = 'rgba(255, 255, 255, 0.03)';
                item.style.borderLeftColor = 'transparent';
            });
            
            // Add active class to current item
            const activeLink = document.querySelector(`.toc-link[href="#${activeId}"]`);
            if (activeLink) {
                const activeItem = activeLink.closest('.toc-item');
                activeItem.style.background = 'rgba(78, 205, 196, 0.15)';
                activeItem.style.borderLeftColor = '#4ecdc4';
                activeItem.style.transform = 'translateX(5px)';
            }
        }
        
        // Rotating Tips Functionality
        function initializeRotatingTips() {
            const tips = [
                "üí° Commit early, commit often - small commits are easier to review and revert",
                "üåø Use descriptive branch names: feature/user-auth, bugfix/login-issue",
                "üö® Never force push to shared branches - it rewrites history for others",
                "üìù Write meaningful commit messages in present tense: 'Add feature' not 'Added feature'",
                "üîÑ Pull before pushing to avoid merge conflicts",
                "üï∞Ô∏è Use reflog to recover from almost any mistake",
                "üìã Use git add -p to stage specific parts of files",
                "üîÄ Use rebase for local branches, merge for shared branches",
                "üíæ Use stash to temporarily save uncommitted changes",
                "üéØ One logical change per commit - keep commits focused",
                "üöÄ Use tags to mark important releases: v1.0, v2.0",
                "üìä Use git log --graph to visualize branch history",
                "üîê Use .gitignore to exclude sensitive files",
                "üèóÔ∏è Understand the three trees: Working ‚Üí Staging ‚Üí Repository",
                "‚ö° Use git bisect to find when a bug was introduced"
            ];
            
            let currentTipIndex = 0;
            const rotatingTipElement = document.getElementById('rotating-tip');
            
            if (!rotatingTipElement) return;
            
            function showNextTip() {
                rotatingTipElement.style.opacity = '0';
                
                setTimeout(() => {
                    rotatingTipElement.textContent = tips[currentTipIndex];
                    rotatingTipElement.style.opacity = '1';
                    currentTipIndex = (currentTipIndex + 1) % tips.length;
                }, 300);
            }
            
            // Show first tip immediately
            showNextTip();
            
            // Rotate tips every 5 seconds
            setInterval(showNextTip, 5000);
            
            // Add transition style
            rotatingTipElement.style.transition = 'opacity 0.3s ease';
        }
        
        // Execute Tip Command Function
        function executeTipCommand(command) {
            // Add visual feedback
            event.target.style.transform = 'scale(0.95)';
            setTimeout(() => {
                event.target.style.transform = '';
            }, 100);
            
            // Copy command to input field instead of executing
            const commandInput = document.getElementById('command-input');
            if (commandInput) {
                commandInput.value = command;
                commandInput.focus();
                
                // Add visual feedback to input
                commandInput.style.borderColor = '#4caf50';
                commandInput.style.boxShadow = '0 0 10px rgba(76, 175, 80, 0.3)';
                
                setTimeout(() => {
                    commandInput.style.borderColor = '';
                    commandInput.style.boxShadow = '';
                }, 500);
            }
        }
        
        function initializeEventListeners() {
            // Main command buttons
            document.querySelectorAll('.main-cmd-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remove active class from all buttons
                    document.querySelectorAll('.main-cmd-btn').forEach(b => b.classList.remove('active'));
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Show auxiliary commands
                    showAuxiliaryCommands(this.dataset.cmd);
                });
            });
            
            // Terminal input
            const terminalInput = document.getElementById('terminal-input');
            terminalInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    const command = this.value.trim();
                    if (command) {
                        executeCommand(command);
                        this.value = '';
                    }
                }
            });
        }
        
        function showAuxiliaryCommands(mainCmd) {
            const auxContainer = document.getElementById('auxiliary-commands');
            const commands = getAuxiliaryCommands(mainCmd);
            
            // Clear container
            auxContainer.innerHTML = '';
            
            // Add header
            const header = document.createElement('h4');
            header.textContent = 'git ' + mainCmd;
            auxContainer.appendChild(header);
            
            // Add command buttons
            commands.forEach(cmd => {
                const button = document.createElement('button');
                button.className = 'aux-cmd-btn';
                button.textContent = cmd;
                button.onclick = () => executeCommand(cmd);
                auxContainer.appendChild(button);
            });
        }
        
        function getAuxiliaryCommands(mainCmd) {
            const sessionData = window.gitProcessor.sessionData;
            
            const commands = {
                'init': ['git init .'],
                'add': [
                    'git add .',
                    'git add ' + (sessionData.lastFileName || ''),
                    'git add *.py',
                    'git add *.js',
                    'git add *.html'
                ],
                'commit': [
                    'git commit -m "' + (sessionData.lastCommitMessage || '') + '"',
                    'git commit -m "Fix bug"',
                    'git commit -m "Add new feature"',
                    'git commit -m "Update documentation"'
                ],
                'branch': [
                    'git branch',
                    'git branch ' + (sessionData.lastBranchName || ''),
                    'git branch -d ' + (sessionData.lastBranchName || ''),
                    'git branch -m old new'
                ],
                'switch': [
                    'git switch ' + (sessionData.lastBranchName || ''),
                    'git switch -c ' + (sessionData.lastBranchName || '') + '-new',
                    'git switch ~',
                    'git switch main'
                ],
                'merge': [
                    'git merge ' + (sessionData.lastBranchName || ''),
                    'git merge --abort'
                ],
                'remote': [
                    'git remote -v',
                    'git remote add origin ' + (sessionData.lastRemoteUrl || ''),
                    'git remote remove origin',
                    'git remote set-url origin ' + (sessionData.lastRemoteUrl || '')
                ],
                'pull': [
                    'git pull',
                    'git pull origin main',
                    'git pull origin ' + (sessionData.lastBranchName || '')
                ],
                'push': [
                    'git push origin main',
                    'git push origin ' + (sessionData.lastBranchName || ''),
                    'git push -u origin main'
                ],
                'config': [
                    'git config --global user.name "' + (sessionData.lastUserName || '') + '"',
                    'git config --global user.email "' + (sessionData.lastUserEmail || '') + '"',
                    'git config --global user.name "Your Name"',
                    'git config --global user.email "your.email@example.com"'
                ],
                'log': [
                    'git log --oneline',
                    'git log -n 5',
                    'git log --graph'
                ],
                'reset': [
                    'git reset HEAD~1',
                    'git reset --soft HEAD~1'
                ],
                'clone': [
                    'git clone ' + (sessionData.lastRemoteUrl || ''),
                    'git clone https://github.com/user/repo.git'
                ],
                'detach': [
                    'git detach',
                    'git checkout HEAD~1', // Alternative way to detach
                    'git checkout <commit-hash>' // Another way to detach
                ],
            };
            
            return commands[mainCmd] || [];
        }
        

        // Contextual Help System
        function updateContextualHelp() {
            if (!window.gitProcessor) return;
            
            const hasRepo = window.gitProcessor.hasGitRepository();
            const currentBranch = window.gitProcessor.timeline.getCurrentBranch();
            const stagedFiles = window.gitProcessor.sessionData.stagedFiles;
            const committedFiles = window.gitProcessor.sessionData.committedFiles;
            const branches = Array.from(window.gitProcessor.timeline.branches.keys());
        async function executeCommand(command) {
            if (window.gitProcessor) {
                await window.gitProcessor.processCommand(command);
                updateTerminal();
                updateTimeline();
                updateTimelineLog(command);
                updateStorageAreas(); // Update storage areas after each command
                updateContextualHelp(); // Update contextual help
                updateBranchIndex(); // Update branch index after each command
                updateGitStatusDisplay(); // Update git status display after each command
                
                // Force timeline update to ensure animation console reflects changes
                setTimeout(() => {
                    updateTimeline();
                }, 100);
            }
        }
            
            if (!hasRepo) {
                helpHTML += `
                    <div class="help-item">
                        <span class="help-icon">üöÄ</span>
                        <div class="help-text">
                            <strong>Getting Started:</strong> Initialize your repository with <code>git init</code>
                        </div>
                    </div>
                    <div class="help-item">
                        <span class="help-icon">üìö</span>
                        <div class="help-text">
                            <strong>What is git init?</strong> Creates a new Git repository in the current directory, setting up all the necessary data structures and metadata for version control.
                        </div>
                    </div>`;
                suggestedHTML += `
                    <button class="aux-cmd-btn" onclick="executeCommand('git init')">git init</button>`;
            } else {
                // Repository exists - show contextual help
                if (stagedFiles.length === 0 && committedFiles.length === 0) {
                    helpHTML += `
                        <div class="help-item">
                            <span class="help-icon">üìù</span>
                            <div class="help-text">
                                <strong>Ready to work:</strong> Create files and stage them with <code>git add</code>
                            </div>
                        </div>
                        <div class="help-item">
                            <span class="help-icon">üåø</span>
                            <div class="help-text">
                                <strong>Current branch:</strong> ${currentBranch || 'main'} ‚Ä¢ Create branches with <code>git branch</code>
                            </div>
                        </div>`;
                    suggestedHTML += `
                        <button class="aux-cmd-btn" onclick="executeCommand('git branch feature')">git branch feature</button>
                        <button class="aux-cmd-btn" onclick="executeCommand('git status')">git status</button>`;
                } else if (stagedFiles.length > 0) {
                    helpHTML += `
                        <div class="help-item">
                            <span class="help-icon">üíæ</span>
                            <div class="help-text">
                                <strong>Ready to commit:</strong> You have ${stagedFiles.length} staged file(s). Use <code>git commit -m "message"</code>
                            </div>
                        </div>
                        <div class="help-item">
                            <span class="help-icon">üìã</span>
                            <div class="help-text">
                                <strong>What is commit?</strong> Creates a snapshot of your staged changes with a descriptive message. This becomes a permanent record in your repository's history that you can return to later.
                            </div>
                        </div>`;
                    suggestedHTML += `
                        <button class="aux-cmd-btn" onclick="executeCommand('git commit -m "Initial commit"')">git commit -m "Initial commit"</button>
                        <button class="aux-cmd-btn" onclick="executeCommand('git status')">git status</button>`;
                } else if (committedFiles.length > 0 && branches.length === 1) {
                    helpHTML += `
                        <div class="help-item">
                            <span class="help-icon">üåø</span>
                            <div class="help-text">
                                <strong>Time to branch:</strong> Create feature branches with <code>git branch</code> to organize your work
                            </div>
                        </div>
                        <div class="help-item">
                            <span class="help-icon">üîÑ</span>
                            <div class="help-text">
                                <strong>What is branching?</strong> Creates an independent line of development. Each branch has its own commit history, allowing you to work on features without affecting the main codebase.
                            </div>
                        </div>`;
                    suggestedHTML += `
                        <button class="aux-cmd-btn" onclick="executeCommand('git branch develop')">git branch develop</button>
                        <button class="aux-cmd-btn" onclick="executeCommand('git switch develop')">git switch develop</button>`;
                } else if (branches.length > 1) {
                    helpHTML += `
                        <div class="help-item">
                            <span class="help-icon">üîÄ</span>
                            <div class="help-text">
                                <strong>Multi-branch workflow:</strong> Switch between branches with <code>git switch</code> or merge with <code>git merge</code>
                            </div>
                        </div>
                        <div class="help-item">
                            <span class="help-icon">üåê</span>
                            <div class="help-text">
                                <strong>What is merge?</strong> Integrates changes from one branch into another. Git automatically creates a merge commit that combines the histories, unless there are conflicts that need manual resolution.
                            </div>
                        </div>`;
                    suggestedHTML += `
                        <button class="aux-cmd-btn" onclick="executeCommand('git switch main')">git switch main</button>
                        <button class="aux-cmd-btn" onclick="executeCommand('git merge develop')">git merge develop</button>`;
                }
                
                // Always add status and log
                suggestedHTML += `
                    <button class="aux-cmd-btn" onclick="executeCommand('git status')">git status</button>
                    <button class="aux-cmd-btn" onclick="executeCommand('git log --oneline')">git log --oneline</button>`;
            }
            
            helpContent.innerHTML = helpHTML;
            suggestedCommands.innerHTML = suggestedHTML;
        }
        
        function toggleHelpPanel() {
            const helpContent = document.getElementById('help-content');
            if (helpContent.style.display === 'none') {
                helpContent.style.display = 'block';
            } else {
                helpContent.style.display = 'none';
            }
        }
        
        // Update help after each command
        function updateHelpAfterCommand() {
            setTimeout(() => {
                updateContextualHelp();
            }, 200);
        }
        async function executeCommand(command) {
            if (window.gitProcessor) {
                await window.gitProcessor.processCommand(command);
                updateTerminal();
                updateTimeline();
                updateTimelineLog(command);
                updateStorageAreas(); // Update storage areas after each command
                updateBranchIndex(); // Update branch index after each command
                updateGitStatusDisplay(); // Update git status display after each command
                
                // Force timeline update to ensure animation console reflects changes
                setTimeout(() => {
                    updateTimeline();
                }, 100);
            }
        }
        
        function updateTerminal() {
            const terminalContent = document.getElementById('terminal-output');
            const output = window.gitProcessor.getTerminalOutput();
            
            terminalContent.innerHTML = output.map(entry => {
                let className = 'terminal-line';
                if (entry.type === 'error') className += ' error';
                if (entry.type === 'success') className += ' success';
                if (entry.type === 'info') className += ' info';
                if (entry.type === 'command') className += ' command';
                
                return `<div class="${className}">${entry.message}</div>`;
            }).join('');
            
            terminalContent.scrollTop = terminalContent.scrollHeight;
        }
        
        function updateTimelineLog(command) {
            const timelineLog = document.getElementById('timeline-log');
            if (!timelineLog) return;
            
            // Add pre-init error logs for common commands
            if (!window.gitProcessor || !window.gitProcessor.hasGitRepository()) {
                const preInitCommands = ['add', 'commit', 'branch', 'merge', 'push', 'pull', 'status', 'log'];
                const commandParts = command.trim().split(' ');
                const mainCommand = commandParts[1];
                
                if (preInitCommands.includes(mainCommand)) {
                    const logEntry = document.createElement('div');
                    logEntry.className = `log-entry error`;
                    
                    const time = new Date().toLocaleTimeString();
                    
                    const errorMessages = {
                        'add': 'Cannot stage files - no Git repository initialized',
                        'commit': 'Cannot commit - no Git repository initialized', 
                        'branch': 'Cannot create branches - no Git repository initialized',
                        'merge': 'Cannot merge - no Git repository initialized',
                        'push': 'Cannot push - no Git repository initialized',
                        'pull': 'Cannot pull - no Git repository initialized',
                        'status': 'Cannot check status - no Git repository initialized',
                        'log': 'Cannot show log - no Git repository initialized'
                    };
                    
                    logEntry.innerHTML = `
                        <div class="log-time">${time}</div>
                        <div class="log-command">${command}</div>
                        <div class="log-description">‚ùå ${errorMessages[mainCommand] || 'Command failed - no Git repository'}</div>
                        <div class="log-description" style="font-size: 0.8em; color: #999; margin-top: 4px;">üí° Try running 'git init' first to initialize a repository</div>
                    `;
                    
                    // Remove the "no logs" message if it exists
                    const noLogs = timelineLog.querySelector('.no-logs');
                    if (noLogs) {
                        noLogs.remove();
                    }
                    
                    // Add the error entry at the top
                    timelineLog.insertBefore(logEntry, timelineLog.firstChild);
                    
                    // Limit to 20 most recent entries
                    const entries = timelineLog.querySelectorAll('.log-entry');
                    if (entries.length > 20) {
                        entries[entries.length - 1].remove();
                    }
                    
                    return;
                }
            }
            
            // Check for terminal errors (new approach)
            if (window.gitProcessor && window.gitProcessor.getTerminalOutput) {
                const terminalOutput = window.gitProcessor.getTerminalOutput();
                const lastEntry = terminalOutput[terminalOutput.length - 1];
                
                // Check if the last terminal entry is an error
                if (lastEntry && lastEntry.type === 'error') {
                    const logEntry = document.createElement('div');
                    logEntry.className = `log-entry error`;
                    
                    const time = new Date().toLocaleTimeString();
                    
                    logEntry.innerHTML = `
                        <div class="log-time">${time}</div>
                        <div class="log-command">${command}</div>
                        <div class="log-description">‚ùå ${lastEntry.message}</div>
                        <div class="log-description" style="font-size: 0.8em; color: #999; margin-top: 4px;">Command failed - see terminal for details</div>
                    `;
                    
                    // Remove the "no logs" message if it exists
                    const noLogs = timelineLog.querySelector('.no-logs');
                    if (noLogs) {
                        noLogs.remove();
                    }
                    
                    // Add the error entry at the top
                    timelineLog.insertBefore(logEntry, timelineLog.firstChild);
                    
                    // Limit to 20 most recent entries
                    const entries = timelineLog.querySelectorAll('.log-entry');
                    if (entries.length > 20) {
                        entries[entries.length - 1].remove();
                    }
                    
                    return;
                }
            }
            
            // Check if there's stored log data from the processor
            if (window.gitProcessor && window.gitProcessor.lastLogData) {
                const logData = window.gitProcessor.lastLogData;
                
                // Create log entry based on type
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry ${logData.type}`;
                
                const time = new Date().toLocaleTimeString();
                
                logEntry.innerHTML = `
                    <div class="log-time">${time}</div>
                    <div class="log-command">${command}</div>
                    <div class="log-description">${logData.description}</div>
                    <div class="log-description" style="font-size: 0.8em; color: #999; margin-top: 4px;">${logData.details}</div>
                `;
                
                // Remove the "no logs" message if it exists
                const noLogs = timelineLog.querySelector('.no-logs');
                if (noLogs) {
                    noLogs.remove();
                }
                
                // Add the entry at the top
                timelineLog.insertBefore(logEntry, timelineLog.firstChild);
                
                // Clear the stored log data
                window.gitProcessor.lastLogData = null;
                
                // Limit to 20 most recent entries
                const entries = timelineLog.querySelectorAll('.log-entry');
                if (entries.length > 20) {
                    entries[entries.length - 1].remove();
                }
                
                return;
            }
            
            // Check if there are any timeline nodes OR if there have been any commands processed
            const timelineData = window.gitProcessor.timeline.getTimelineData();
            const allNodes = Array.from(timelineData.nodes.values());
            
            // Also check if we have any terminal output (indicating commands were attempted)
            const terminalOutputData = window.gitProcessor.getTerminalOutput();
            const hasCommands = terminalOutputData.length > 0;
            
            if (allNodes.length === 0 && !hasCommands) {
                timelineLog.innerHTML = '<div class="no-logs">No Git commands executed yet.</div>';
                return;
            }
            
            // If there are no nodes but there are commands (like errors), show a message
            if (allNodes.length === 0 && hasCommands) {
                // Look for the last command that might have failed
                const lastTerminalEntry = terminalOutputData[terminalOutputData.length - 1];
                if (lastTerminalEntry && lastTerminalEntry.type === 'error') {
                    // This is already handled by the error case above
                    return;
                }
                
                // If no nodes but commands exist, show a message
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry info`;
                
                const time = new Date().toLocaleTimeString();
                
                logEntry.innerHTML = `
                    <div class="log-time">${time}</div>
                    <div class="log-command">${command}</div>
                    <div class="log-description">‚ÑπÔ∏è Command processed - No timeline nodes created</div>
                    <div class="log-description" style="font-size: 0.8em; color: #999; margin-top: 4px;">This command doesn't create timeline entries</div>
                `;
                
                // Remove the "no logs" message if it exists
                const noLogs = timelineLog.querySelector('.no-logs');
                if (noLogs) {
                    noLogs.remove();
                }
                
                // Add the entry at the top
                timelineLog.insertBefore(logEntry, timelineLog.firstChild);
                
                // Limit to 20 most recent entries
                const entries = timelineLog.querySelectorAll('.log-entry');
                if (entries.length > 20) {
                    entries[entries.length - 1].remove();
                }
                
                return;
            }
            
            // Get the most recent node (last one in the array)
            const latestNode = allNodes[allNodes.length - 1];
            
            // Create log entry
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${latestNode.type}`;
            
            // Format time
            const time = new Date(latestNode.timestamp).toLocaleTimeString();
            
            // Get terminal output to check for errors and extract details
            const terminalOutput = window.gitProcessor.getTerminalOutput();
            const lastOutput = terminalOutput[terminalOutput.length - 1];
            const hasError = lastOutput && lastOutput.type === 'error';
            
            // Get detailed description based on command and results
            let description = '';
            const commandParts = command.trim().split(' ');
            const mainCommand = commandParts[1];
            
            if (hasError) {
                description = `‚ùå ${lastOutput.message || 'Command failed'}`;
            } else {
                // Additional check for specific error messages that might not be marked as 'error' type
                if (lastOutput && lastOutput.message) {
                    const errorMsg = lastOutput.message;
                    if (errorMsg.includes('nothing to commit') || 
                        errorMsg.includes('fatal: not a git repository') ||
                        errorMsg.includes('fatal:') ||
                        errorMsg.includes('error:')) {
                        description = `‚ùå ${errorMsg}`;
                        return; // Skip the switch statement for errors
                    }
                }
                
                switch (mainCommand) {
                    case 'init':
                        if (commandParts.includes('--bare')) {
                            description = 'üÜï Initialized a new bare Git repository';
                        } else if (commandParts.length > 2) {
                            description = `üÜï Initialized Git repository in "${commandParts[2]}"`;
                        } else {
                            description = 'üÜï Initialized a new Git repository in current directory';
                        }
                        break;
                        
                    case 'add':
                        if (commandParts.includes('.')) {
                            description = 'üìÅ Added all files to staging area';
                        } else if (commandParts.includes('-A')) {
                            description = 'üìÅ Added all files including deletions to staging area';
                        } else if (commandParts.includes('-p')) {
                            description = 'üìù Added selected patches to staging area interactively';
                        } else {
                            const files = commandParts.slice(2).join(', ');
                            description = `üìÑ Added "${files}" to staging area`;
                        }
                        break;
                        
                    case 'commit':
                        const commitMatch = command.match(/-m\s+"([^"]+)"/);
                        const commitMessage = commitMatch ? commitMatch[1] : 'No message';
                        if (latestNode.data.shortHash) {
                            description = `‚úÖ Created commit ${latestNode.data.shortHash}: "${commitMessage}"`;
                        } else {
                            description = `‚úÖ Created commit: "${commitMessage}"`;
                        }
                        break;
                        
                    case 'branch':
                        if (commandParts.includes('-d') || commandParts.includes('-D')) {
                            const branchName = commandParts[commandParts.indexOf('-d') + 1] || commandParts[commandParts.indexOf('-D') + 1];
                            description = `üóëÔ∏è Deleted branch "${branchName}"`;
                        } else if (commandParts.includes('-m')) {
                            const oldName = commandParts[commandParts.indexOf('-m') + 1];
                            const newName = commandParts[commandParts.indexOf('-m') + 2];
                            description = `üîÑ Renamed branch "${oldName}" to "${newName}"`;
                        } else if (commandParts.includes('-a')) {
                            description = 'üìã Listed all branches (local and remote)';
                        } else if (commandParts.length > 2) {
                            description = `üåø Created new branch "${commandParts[2]}"`;
                        } else {
                            description = 'üìã Listed all local branches';
                        }
                        break;
                        
                    case 'switch':
                    case 'checkout':
                        if (commandParts.includes('-c')) {
                            const branchName = commandParts[commandParts.indexOf('-c') + 1];
                            description = `üåø Created and switched to new branch "${branchName}"`;
                        } else if (commandParts[2] === '-') {
                            description = 'üîÑ Switched to previous branch';
                        } else {
                            const branchName = commandParts[2];
                            description = `üîÑ Switched from current branch to "${branchName}"`;
                        }
                        break;
                        
                    case 'merge':
                        const branchName = commandParts[2];
                        if (commandParts.includes('--no-ff')) {
                            description = `üîÄ Merged "${branchName}" into current branch (no fast-forward)`;
                        } else if (commandParts.includes('--abort')) {
                            description = '‚ùå Aborted merge operation';
                        } else {
                            description = `üîÄ Merged "${branchName}" into current branch`;
                        }
                        break;
                        
                    case 'pull':
                        if (commandParts.length > 2) {
                            const remote = commandParts[2];
                            const branch = commandParts[3] || 'main';
                            description = `‚¨áÔ∏è Pulled changes from "${remote}/${branch}"`;
                        } else {
                            description = '‚¨áÔ∏è Pulled changes from default remote';
                        }
                        break;
                        
                    case 'push':
                        if (commandParts.includes('-u')) {
                            const remote = commandParts[2];
                            const branch = commandParts[3];
                            description = `‚¨ÜÔ∏è Pushed "${branch}" to "${remote}" and set upstream`;
                        } else if (commandParts.includes('--force')) {
                            const remote = commandParts[2];
                            const branch = commandParts[3];
                            description = `‚¨ÜÔ∏è Force pushed "${branch}" to "${remote}"`;
                        } else if (commandParts.length > 2) {
                            const remote = commandParts[2];
                            const branch = commandParts[3];
                            description = `‚¨ÜÔ∏è Pushed "${branch}" to "${remote}"`;
                        } else {
                            description = '‚¨ÜÔ∏è Pushed changes to default remote';
                        }
                        break;
                        
                    case 'remote':
                        if (commandParts.includes('add')) {
                            const name = commandParts[commandParts.indexOf('add') + 1];
                            const url = commandParts[commandParts.indexOf('add') + 2];
                            description = `üåê Added remote "${name}" pointing to ${url}`;
                        } else if (commandParts.includes('remove')) {
                            const name = commandParts[commandParts.indexOf('remove') + 1];
                            description = `üóëÔ∏è Removed remote "${name}"`;
                        } else if (commandParts.includes('-v')) {
                            description = 'üìã Listed all remotes with URLs';
                        } else {
                            description = 'üåê Remote operation completed';
                        }
                        break;
                        
                    case 'clone':
                        const url = commandParts[2];
                        const targetDir = commandParts[3];
                        if (targetDir) {
                            description = `üì• Cloned repository from ${url} into "${targetDir}"`;
                        } else {
                            description = `üì• Cloned repository from ${url}`;
                        }
                        break;
                        
                    case 'config':
                        if (commandParts.includes('--global')) {
                            if (command.includes('user.name')) {
                                const nameMatch = command.match(/user\.name\s+"([^"]+)"/);
                                const name = nameMatch ? nameMatch[1] : 'updated';
                                description = `‚öôÔ∏è Set global user name to "${name}"`;
                            } else if (command.includes('user.email')) {
                                const emailMatch = command.match(/user\.email\s+"([^"]+)"/);
                                const email = emailMatch ? emailMatch[1] : 'updated';
                                description = `‚öôÔ∏è Set global user email to "${email}"`;
                            } else {
                                description = '‚öôÔ∏è Updated global Git configuration';
                            }
                        } else {
                            description = '‚öôÔ∏è Updated Git configuration';
                        }
                        break;
                        
                    case 'log':
                        if (commandParts.includes('--oneline')) {
                            description = 'üìú Displayed commit history in compact format';
                        } else if (commandParts.includes('--graph')) {
                            description = 'üìú Displayed commit history with branch graph';
                        } else if (commandParts.includes('-n')) {
                            const count = commandParts[commandParts.indexOf('-n') + 1];
                            description = `üìú Displayed last ${count} commits`;
                        } else {
                            description = 'üìú Displayed full commit history';
                        }
                        break;
                        
                    case 'reset':
                        if (commandParts.includes('--hard')) {
                            const ref = commandParts[commandParts.indexOf('--hard') + 1] || 'HEAD';
                            description = `üîÑ Hard reset to ${ref} (discarded all changes)`;
                        } else if (commandParts.includes('--soft')) {
                            const ref = commandParts[commandParts.indexOf('--soft') + 1] || 'HEAD';
                            description = `üîÑ Soft reset to ${ref} (kept changes staged)`;
                        } else {
                            const ref = commandParts[2] || 'HEAD';
                            description = `üîÑ Mixed reset to ${ref} (unstaged changes)`;
                        }
                        break;
                        
                    case 'status':
                        description = 'üìä Checked repository status';
                        break;
                        
                    default:
                        description = `‚ö° Executed: ${command}`;
                }
            }
            
            logEntry.innerHTML = `
                <div class="log-time">${time}</div>
                <div class="log-command">${command}</div>
                <div class="log-description">${description}</div>
            `;
            
            // Remove the "no logs" message if it exists
            const noLogs = timelineLog.querySelector('.no-logs');
            if (noLogs) {
                noLogs.remove();
            }
            
            // Add the new entry at the top
            timelineLog.insertBefore(logEntry, timelineLog.firstChild);
            
            // Limit to 20 most recent entries
            const entries = timelineLog.querySelectorAll('.log-entry');
            if (entries.length > 20) {
                entries[entries.length - 1].remove();
            }
        }
        
        function updateTimeline() {
            const timelineData = window.gitProcessor.timeline.getTimelineData();
            
            // Update the animation console with Git branching visualization
            renderGitGraph(timelineData);
        }
        
        // Git Graph Visualization System
        class GitGraphVisualizer {
            constructor() {
                this.svg = document.getElementById('branch-visualizer');
                this.nodesContainer = document.getElementById('commit-nodes');
                this.timelineContainer = document.querySelector('.timeline-container');
                this.branchYPositions = new Map();
                this.commitSpacing = 150;
                this.branchSpacing = 120; // Increased from 80 to prevent HEAD overlap
                this.currentX = 50;
                this.nodeElements = new Map();
                this.edgeElements = new Map();
                this.branchColors = {
                    'main': '#4ecdc4',
                    'master': '#4ecdc4', 
                    'develop': '#ff6b6b',
                    'design_codes': '#2196F3',
                    'logic_codes': '#9C27B0',
                    'database_schema': '#FF5722',
                    'ui_components': '#00BCD4',
                    'api_endpoints': '#FF9800',
                    'testing_suite': '#4CAF50',
                    'documentation': '#795548',
                    'deployment': '#F44336',
                    'remote': '#48dbfb'
                };
                
                // Zoom and pan state
                this.zoom = 1;
                this.panX = 0;
                this.panY = 0;
                this.isDragging = false;
                this.dragStartX = 0;
                this.dragStartY = 0;
                
                this.initializeInteractions();
            }
            
            initializeInteractions() {
                if (!this.svg) return;
                
                // Mouse wheel zoom
                this.svg.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    const delta = e.deltaY > 0 ? 0.9 : 1.1;
                    this.setZoom(this.zoom * delta);
                });
                
                // Mouse drag pan
                this.svg.addEventListener('mousedown', (e) => {
                    this.isDragging = true;
                    this.dragStartX = e.clientX - this.panX;
                    this.dragStartY = e.clientY - this.panY;
                    this.svg.style.cursor = 'grabbing';
                });
                
                document.addEventListener('mousemove', (e) => {
                    if (this.isDragging) {
                        this.panX = e.clientX - this.dragStartX;
                        this.panY = e.clientY - this.dragStartY;
                        this.updateTransform();
                    }
                });
                
                document.addEventListener('mouseup', () => {
                    this.isDragging = false;
                    this.svg.style.cursor = 'grab';
                });
            }
            
            setZoom(newZoom) {
                this.zoom = Math.min(Math.max(newZoom, 0.3), 3);
                this.updateTransform();
            }
            
            updateTransform() {
                const transform = `translate(${this.panX}px, ${this.panY}px) scale(${this.zoom})`;
                if (this.svg) {
                    this.svg.style.transform = transform;
                }
                if (this.nodesContainer) {
                    this.nodesContainer.style.transform = transform;
                }
            }
            
            resetView() {
                this.zoom = 1;
                this.panX = 0;
                this.panY = 0;
                this.updateTransform();
            }
            
            centerView() {
                if (!this.timelineContainer) return;
                
                const containerRect = this.timelineContainer.getBoundingClientRect();
                const contentWidth = this.currentX + 100;
                const contentHeight = (this.branchYPositions.size * this.branchSpacing) + 200;
                
                // Calculate center offsets
                this.panX = (containerRect.width - contentWidth * this.zoom) / 2;
                this.panY = (containerRect.height - contentHeight * this.zoom) / 2;
                
                this.updateTransform();
            }
            
            getBranchColor(branchName) {
                // Use the predefined realistic branch colors first
                if (this.branchColors[branchName]) {
                    return this.branchColors[branchName];
                }
                
                // Generate color based on branch name hash for consistency
                let hash = 0;
                for (let i = 0; i < branchName.length; i++) {
                    hash = branchName.charCodeAt(i) + ((hash << 5) - hash);
                }
                
                const colors = ['#ff6b6b', '#feca57', '#ff9ff3', '#54a0ff', '#48dbfb', '#1dd1a1', '#ff6348', '#30336b'];
                return colors[Math.abs(hash) % colors.length];
            }
            
            getBranchYPosition(branchName) {
                if (!this.branchYPositions.has(branchName)) {
                    const index = this.branchYPositions.size;
                    this.branchYPositions.set(branchName, 100 + (index * this.branchSpacing));
                }
                return this.branchYPositions.get(branchName);
            }
            
            clearVisualization() {
                if (this.svg) {
                    this.svg.innerHTML = '';
                }
                if (this.nodesContainer) {
                    this.nodesContainer.innerHTML = '';
                }
                this.nodeElements.clear();
                this.edgeElements.clear();
                this.branchYPositions.clear();
                this.currentX = 50;
            }
            
            render(timelineData) {
                console.log('Main render called, nodes count:', timelineData.nodes.length);
                console.log('Existing node elements count:', this.nodeElements.size);
                
                if (!timelineData.nodes || timelineData.nodes.length === 0) {
                    this.showEmptyState();
                    return;
                }
                
                // Always redraw branch lines and edges to ensure they're visible
                // Only clear if this is the first render
                if (this.nodeElements.size === 0) {
                    this.clearVisualization();
                }
                
                // Group nodes by branch and calculate positions
                const branchNodes = this.groupNodesByBranch(timelineData.nodes);
                const nodePositions = this.calculateNodePositions(branchNodes);
                
                // Expand canvas to fit all content
                this.expandCanvasToFit(nodePositions);
                
                // Clear and redraw branch lines and edges to ensure visibility
                this.clearBranchLinesAndEdges();
                
                // Draw branch lines first (background)
                this.drawBranchLines(branchNodes, nodePositions);
                
                // Update branch line styles based on current branch
                this.updateBranchLineStyles();
                
                // Draw edges/connections
                this.drawEdges(timelineData.edges, nodePositions);
                
                // Draw only new commit nodes (incremental rendering)
                this.drawNewCommitNodes(timelineData.nodes, nodePositions);
                
                // Add current HEAD indicator - use the new radio button HEAD tracking
                this.drawHeadIndicator(timelineData.nodes, nodePositions);
                
                // Focus on the newest node instead of auto-centering
                this.focusOnNewestNode(timelineData.nodes, nodePositions);
            }
            
            expandCanvasToFit(nodePositions) {
                if (nodePositions.size === 0) return;
                
                // Find the bounds of all positioned nodes
                let minX = Infinity, maxX = -Infinity;
                let minY = Infinity, maxY = -Infinity;
                
                nodePositions.forEach(pos => {
                    minX = Math.min(minX, pos.x - 100); // Add padding
                    maxX = Math.max(maxX, pos.x + 100);
                    minY = Math.min(minY, pos.y - 100);
                    maxY = Math.max(maxY, pos.y + 100);
                });
                
                // Calculate required dimensions
                const width = maxX - minX;
                const height = maxY - minY;
                
                // Update SVG dimensions
                if (this.svg) {
                    this.svg.setAttribute('viewBox', `${minX} ${minY} ${width} ${height}`);
                    this.svg.style.width = `${width}px`;
                    this.svg.style.height = `${height}px`;
                }
                
                // Update nodes container dimensions
                if (this.nodesContainer) {
                    this.nodesContainer.style.width = `${width}px`;
                    this.nodesContainer.style.height = `${height}px`;
                    this.nodesContainer.style.position = 'relative'; // Ensure proper positioning
                }
                
                // Don't resize parent containers - only expand the canvas itself
                // This prevents the terminal/console area from expanding
                console.log(`Canvas expanded to: ${width}x${height}`);
            }
            
            clearBranchLinesAndEdges() {
                if (!this.svg) return;
                
                // Remove all branch lines and labels
                this.svg.querySelectorAll('[data-branch]').forEach(element => element.remove());
                this.svg.querySelectorAll('[data-branch-label]').forEach(element => element.remove());
                
                // Remove all edge paths and groups
                this.svg.querySelectorAll('path').forEach(element => element.remove());
                this.svg.querySelectorAll('g').forEach(element => element.remove());
                
                // Clear edge elements tracking
                this.edgeElements.clear();
            }
            
            focusOnNewestNode(nodes, nodePositions) {
                if (nodes.length === 0) return;
                
                // Find the newest node (most recent timestamp)
                const newestNode = nodes.reduce((newest, node) => {
                    return new Date(node.timestamp) > new Date(newest.timestamp) ? node : newest;
                });
                
                const newestPos = nodePositions.get(newestNode.id);
                if (!newestPos) return;
                
                // Calculate center position to show the newest node
                const containerWidth = this.nodesContainer.clientWidth;
                const containerHeight = this.nodesContainer.clientHeight;
                
                const centerX = newestPos.x - containerWidth / 2;
                const centerY = newestPos.y - containerHeight / 2;
                
                // Apply smooth pan to center on newest node
                setTimeout(() => {
                    this.nodesContainer.style.transition = 'transform 0.5s ease';
                    this.nodesContainer.style.transform = `translate(${-centerX}px, ${-centerY}px)`;
                    this.svg.style.transition = 'transform 0.5s ease';
                    this.svg.style.transform = `translate(${-centerX}px, ${-centerY}px)`;
                }, 100);
            }
            
            showEmptyState() {
                if (this.nodesContainer) {
                    this.nodesContainer.innerHTML = `
                        <div style="display: flex; align-items: center; justify-content: center; height: 100%; flex-direction: column; gap: 15px; padding: 40px;">
                            <div style="font-size: 1.1em; color: #999; font-family: monospace;">
                                Type "git init" to start
                            </div>
                            <div style="font-size: 0.9em; color: #aaa; text-align: center;">
                                Git state machine visualization will appear here
                            </div>
                            <div style="font-size: 0.8em; color: #bbb; text-align: center; max-width: 300px;">
                                Nodes show repository states ‚Ä¢ Edges show Git commands
                            </div>
                        </div>
                    `;
                }
                
                // Add arrow marker definition to SVG
                if (this.svg) {
                    const svgNS = 'http://www.w3.org/2000/svg';
                    const defs = document.createElementNS(svgNS, 'defs');
                    
                    const marker = document.createElementNS(svgNS, 'marker');
                    marker.setAttribute('id', 'arrowhead');
                    marker.setAttribute('markerWidth', '10');
                    marker.setAttribute('markerHeight', '7');
                    marker.setAttribute('refX', '9');
                    marker.setAttribute('refY', '3.5');
                    marker.setAttribute('orient', 'auto');
                    
                    const polygon = document.createElementNS(svgNS, 'polygon');
                    polygon.setAttribute('points', '0 0, 10 3.5, 0 7');
                    polygon.setAttribute('fill', '#666');
                    
                    marker.appendChild(polygon);
                    defs.appendChild(marker);
                    this.svg.appendChild(defs);
                }
            }
            
            groupNodesByBranch(nodes) {
                const branchNodes = new Map();
                let currentBranch = 'main'; // Default to main
                
                // Create a timeline of branch context changes
                const branchTimeline = [];
                
                // Nodes are already sorted chronologically from getTimelineData
                
                nodes.forEach((node, index) => {
                    let branch = currentBranch;
                    
                    // Track branch context changes
                    if (node.type === 'branch' && node.data.branch) {
                        // Branch creation - creates new branch but doesn't switch to it
                        branchTimeline.push({
                            timestamp: node.timestamp,
                            type: 'create_branch',
                            branch: node.data.branch,
                            currentBranch: currentBranch
                        });
                    }
                    
                    if (node.type === 'switch' && node.data.branch) {
                        // Branch switch - changes current branch context
                        currentBranch = node.data.branch;
                        branchTimeline.push({
                            timestamp: node.timestamp,
                            type: 'switch_branch',
                            branch: currentBranch,
                            currentBranch: currentBranch
                        });
                    }
                    
                    // Determine which branch this node belongs to
                    if (node.type === 'branch' && node.data.branch) {
                        branch = node.data.branch; // Branch creation node belongs to its own branch
                    } else if (node.type === 'switch') {
                        branch = node.data.branch; // Switch node belongs to target branch
                    } else {
                        branch = currentBranch; // All other operations follow current branch
                    }
                    
                    if (!branchNodes.has(branch)) {
                        branchNodes.set(branch, []);
                    }
                    branchNodes.get(branch).push(node);
                });
                
                return branchNodes;
            }
            
            calculateNodePositions(branchNodes) {
                const positions = new Map();
                let globalMaxTime = 50; // Global time position for all branches
                
                // Sort ALL nodes by timestamp to establish global time progression
                const allNodes = [];
                branchNodes.forEach((nodes, branchName) => {
                    nodes.forEach(node => {
                        allNodes.push({ node, branchName });
                    });
                });
                
                // Sort by timestamp to get chronological order
                allNodes.sort((a, b) => new Date(a.node.timestamp) - new Date(b.node.timestamp));
                
                // Position nodes based on global time, not branch sequence
                allNodes.forEach(({ node, branchName }, index) => {
                    const timePosition = 50 + (index * this.commitSpacing);
                    const y = this.getBranchYPosition(branchName);
                    
                    positions.set(node.id, { x: timePosition, y, branch: branchName });
                    globalMaxTime = Math.max(globalMaxTime, timePosition);
                });
                
                this.currentX = globalMaxTime;
                return positions;
            }
            
            getCurrentTimePosition(positions, branchNodes) {
                // Find the rightmost position among all positioned nodes
                let maxTimeX = 50;
                
                positions.forEach((pos) => {
                    maxTimeX = Math.max(maxTimeX, pos.x);
                });
                
                // Add spacing for the new node
                return maxTimeX + this.commitSpacing;
            }
            
            findHeadPosition(positions, branchNodes) {
                // Find the current HEAD position (rightmost node on current branch)
                let headX = 50;
                let headY = this.getBranchYPosition('main');
                
                // Look for the rightmost node that should be the HEAD
                for (const [nodeId, pos] of positions.entries()) {
                    if (pos.x > headX) {
                        headX = pos.x;
                        headY = pos.y;
                    }
                }
                
                return { x: headX, y: headY };
            }
            
            drawBranchLines(branchNodes, nodePositions) {
                if (!this.svg) return;
                
                const svgNS = 'http://www.w3.org/2000/svg';
                
                branchNodes.forEach((nodes, branchName) => {
                    if (nodes.length === 0) return;
                    
                    const y = this.getBranchYPosition(branchName);
                    const color = this.getBranchColor(branchName);
                    
                    let startX = 30;
                    let rightmostX = startX;
                    
                    // Find the actual node positions for this branch
                    const branchNodePositions = [];
                    nodePositions.forEach((pos, nodeId) => {
                        if (pos.branch === branchName) {
                            branchNodePositions.push(pos);
                            rightmostX = Math.max(rightmostX, pos.x);
                        }
                    });
                    
                    // For non-main branches, start from the first node on that branch
                    if (branchName !== 'main' && branchNodePositions.length > 0) {
                        // Sort by x position to find the leftmost node
                        branchNodePositions.sort((a, b) => a.x - b.x);
                        startX = branchNodePositions[0].x;
                    }
                    
                    // Check if branch line already exists
                    const existingLine = this.svg.querySelector(`[data-branch="${branchName}"]`);
                    if (existingLine) {
                        // Update existing line to extend further if needed
                        existingLine.setAttribute('x1', startX);
                        existingLine.setAttribute('x2', rightmostX + 50); // Extend past last node
                        existingLine.setAttribute('y1', y);
                        existingLine.setAttribute('y2', y);
                        
                        // Update existing label position to the end
                        const existingLabel = this.svg.querySelector(`[data-branch-label="${branchName}"]`);
                        if (existingLabel) {
                            existingLabel.setAttribute('x', rightmostX + 60);
                            existingLabel.setAttribute('y', y - 5);
                            existingLabel.setAttribute('font-size', '14'); // Increased size
                            existingLabel.setAttribute('stroke', 'white'); // White outline
                            existingLabel.setAttribute('stroke-width', '1');
                            existingLabel.setAttribute('stroke-linejoin', 'round');
                            existingLabel.style.zIndex = '100'; // Ensure visibility
                            console.log(`Updated branch label ${branchName} position:`, rightmostX + 60, y - 5);
                        }
                        return;
                    }
                    
                    // Draw new branch line from start to rightmost node
                    const line = document.createElementNS(svgNS, 'line');
                    line.setAttribute('data-branch', branchName); // Mark for future updates
                    line.setAttribute('x1', startX);
                    line.setAttribute('y1', y);
                    line.setAttribute('x2', rightmostX + 50); // Extend past last node
                    line.setAttribute('y2', y);
                    line.setAttribute('stroke', color);
                    line.setAttribute('stroke-width', '2');
                    line.setAttribute('stroke-opacity', '0.6');
                    line.setAttribute('stroke-dasharray', '5,3');
                    
                    this.svg.appendChild(line);
                    
                    // Add branch label at the END of the line (right side)
                    const text = document.createElementNS(svgNS, 'text');
                    text.setAttribute('data-branch-label', branchName);
                    text.setAttribute('x', rightmostX + 60); // Position at the end
                    text.setAttribute('y', y - 5); // Slightly above the line
                    text.setAttribute('text-anchor', 'start'); // Align from left
                    text.setAttribute('font-size', '14'); // Increased size for visibility
                    text.setAttribute('font-family', 'monospace');
                    text.setAttribute('fill', color);
                    text.setAttribute('font-weight', 'bold');
                    text.setAttribute('stroke', 'white'); // White outline for contrast
                    text.setAttribute('stroke-width', '1');
                    text.setAttribute('stroke-linejoin', 'round');
                    text.style.pointerEvents = 'none'; // Prevent interference
                    text.style.zIndex = '100'; // Ensure it's above other elements
                    
                    console.log(`Creating branch label for ${branchName} at position:`, rightmostX + 60, y - 5);
                    
                    // Add subtle animation for label appearance
                    text.style.opacity = '0';
                    text.style.transition = 'opacity 0.3s ease';
                    
                    this.svg.appendChild(text);
                    
                    // Animate label appearance
                    setTimeout(() => {
                        text.style.opacity = '1';
                        console.log(`Branch label ${branchName} shown`);
                    }, 100);
                });
            }
            
            updateBranchLineStyles() {
                if (!this.svg) return;
                
                const currentBranch = window.gitProcessor ? window.gitProcessor.timeline.getCurrentBranch() : 'main';
                
                // Update all branch lines
                document.querySelectorAll('[data-branch]').forEach(line => {
                    const branchName = line.getAttribute('data-branch');
                    const color = this.getBranchColor(branchName);
                    const isCurrentBranch = branchName === currentBranch;
                    
                    if (isCurrentBranch) {
                        // Current branch: full color, visible
                        line.setAttribute('stroke', color);
                        line.setAttribute('stroke-width', '3');
                        line.setAttribute('stroke-opacity', '1');
                        line.style.filter = `drop-shadow(0 0 3px ${color})`;
                    } else {
                        // Non-current branch: grey, less visible
                        line.setAttribute('stroke', '#666');
                        line.setAttribute('stroke-width', '2');
                        line.setAttribute('stroke-opacity', '0.3');
                        line.style.filter = 'none';
                    }
                });
                
                // Update all branch labels
                document.querySelectorAll('[data-branch-label]').forEach(text => {
                    const branchName = text.getAttribute('data-branch-label');
                    const color = this.getBranchColor(branchName);
                    const isCurrentBranch = branchName === currentBranch;
                    
                    text.setAttribute('font-weight', isCurrentBranch ? 'bold' : 'normal');
                    text.setAttribute('fill', isCurrentBranch ? color : '#999');
                    text.style.filter = isCurrentBranch ? `drop-shadow(0 0 3px ${color})` : 'none';
                });
            }
            
            drawEdges(edges, nodePositions) {
                if (!this.svg) return;
                
                const svgNS = 'http://www.w3.org/2000/svg';
                
                edges.forEach((edge, index) => {
                    // Skip if this edge already exists
                    if (this.edgeElements.has(edge.id)) {
                        return;
                    }
                    
                    const fromPos = nodePositions.get(edge.from);
                    const toPos = nodePositions.get(edge.to);
                    
                    if (!fromPos || !toPos) return;
                    
                    // Create curved path for edges
                    const midX = (fromPos.x + toPos.x) / 2;
                    const controlY = Math.min(fromPos.y, toPos.y) - 30;
                    
                    const d = `M ${fromPos.x} ${fromPos.y} Q ${midX} ${controlY} ${toPos.x} ${toPos.y}`;
                    
                    const path = document.createElementNS(svgNS, 'path');
                    path.setAttribute('d', d);
                    
                    // Edge styling with highest z-index
                    path.setAttribute('stroke', '#666');
                    path.setAttribute('stroke-width', '2');
                    path.setAttribute('stroke-opacity', '0.8');
                    path.setAttribute('fill', 'none');
                    path.setAttribute('marker-end', 'url(#arrowhead)');
                    
                    // Set highest z-index to be above all nodes
                    path.style.zIndex = '1000';
                    path.style.pointerEvents = 'stroke'; // Only interact with edge lines
                    
                    // Add hover effect for edges
                    path.addEventListener('mouseenter', () => {
                        path.setAttribute('stroke', '#4ecdc4');
                        path.setAttribute('stroke-width', '3');
                        path.style.filter = 'drop-shadow(0 0 5px rgba(78, 205, 196, 0.5))';
                    });
                    
                    path.addEventListener('mouseleave', () => {
                        path.setAttribute('stroke', '#666');
                        path.setAttribute('stroke-width', '2');
                        path.style.filter = 'none';
                    });
                    
                    // Add click event to show edge details
                    path.addEventListener('click', () => {
                        this.showEdgeDetails(edge);
                    });
                    
                    this.svg.appendChild(path);
                    
                    // Add command label only for important operations
                    if (edge.command && (edge.command.includes('commit') || edge.command.includes('merge') || edge.command.includes('push') || edge.command.includes('pull'))) {
                        const commandText = edge.command || 'transition';
                        const displayText = this.truncateCommand(commandText, 15);
                        
                        // Add command label on the edge
                        const text = document.createElementNS(svgNS, 'text');
                        text.setAttribute('x', midX);
                        text.setAttribute('y', controlY);
                        text.setAttribute('text-anchor', 'middle');
                        text.setAttribute('font-size', '10');
                        text.setAttribute('font-family', 'monospace');
                        text.setAttribute('fill', '#333');
                        text.setAttribute('font-weight', 'bold');
                        text.style.cursor = 'pointer';
                        text.textContent = displayText;
                        
                        // Add background rectangle
                        const rect = document.createElementNS(svgNS, 'rect');
                        const bbox = text.getBBox();
                        rect.setAttribute('x', bbox.x - 4);
                        rect.setAttribute('y', bbox.y - 2);
                        rect.setAttribute('width', bbox.width + 8);
                        rect.setAttribute('height', bbox.height + 4);
                        rect.setAttribute('fill', 'white');
                        rect.setAttribute('stroke', '#ddd');
                        rect.setAttribute('stroke-width', '1');
                        rect.setAttribute('rx', '3');
                        rect.style.cursor = 'pointer';
                        
                        // Add click interaction
                        const edgeGroup = document.createElementNS(svgNS, 'g');
                        edgeGroup.appendChild(rect);
                        edgeGroup.appendChild(text);
                        
                        edgeGroup.dataset.fullCommand = commandText;
                        edgeGroup.dataset.edgeId = edge.id;
                        
                        edgeGroup.addEventListener('click', () => {
                            this.toggleEdgeDetails(edge.id, commandText, midX, controlY);
                        });
                        
                        edgeGroup.addEventListener('mouseenter', () => {
                            if (!this.activeEdgeDetails || this.activeEdgeDetails !== edge.id) {
                                edgeGroup.title = commandText;
                            }
                        });
                        
                        this.svg.appendChild(edgeGroup);
                        this.edgeElements.set(edge.id, { path, group: edgeGroup, text, rect });
                    } else {
                        this.edgeElements.set(edge.id, { path });
                    }
                });
            }
            
            truncateCommand(command, maxLength) {
                if (command.length <= maxLength) return command;
                return command.substring(0, maxLength - 3) + '...';
            }
            
            toggleEdgeDetails(edgeId, fullCommand, x, y) {
                // Remove existing details if showing different edge
                if (this.activeEdgeDetails && this.activeEdgeDetails !== edgeId) {
                    this.removeEdgeDetails();
                }
                
                // Toggle details for current edge
                if (this.activeEdgeDetails === edgeId) {
                    this.removeEdgeDetails();
                } else {
                    this.showEdgeDetails(edgeId, fullCommand, x, y);
                }
            }
            
            showEdgeDetails(edgeId, fullCommand, x, y) {
                const svgNS = 'http://www.w3.org/2000/svg';
                
                // Create detailed text
                const detailText = document.createElementNS(svgNS, 'text');
                detailText.setAttribute('x', x);
                detailText.setAttribute('y', y);
                detailText.setAttribute('text-anchor', 'middle');
                detailText.setAttribute('font-size', '11');
                detailText.setAttribute('font-family', 'monospace');
                detailText.setAttribute('fill', '#000');
                detailText.setAttribute('font-weight', 'bold');
                detailText.textContent = fullCommand;
                
                // Create background for detailed text
                const bbox = detailText.getBBox();
                const detailRect = document.createElementNS(svgNS, 'rect');
                detailRect.setAttribute('x', bbox.x - 6);
                detailRect.setAttribute('y', bbox.y - 3);
                detailRect.setAttribute('width', bbox.width + 12);
                detailRect.setAttribute('height', bbox.height + 6);
                detailRect.setAttribute('fill', '#fff');
                detailRect.setAttribute('stroke', '#333');
                detailRect.setAttribute('stroke-width', '2');
                detailRect.setAttribute('rx', '4');
                
                // Create group for details
                const detailGroup = document.createElementNS(svgNS, 'g');
                detailGroup.id = `edge-details-${edgeId}`;
                detailGroup.appendChild(detailRect);
                detailGroup.appendChild(detailText);
                
                this.svg.appendChild(detailGroup);
                this.activeEdgeDetails = edgeId;
            }
            
            removeEdgeDetails() {
                if (this.activeEdgeDetails) {
                    const detailElement = document.getElementById(`edge-details-${this.activeEdgeDetails}`);
                    if (detailElement) {
                        detailElement.remove();
                    }
                    this.activeEdgeDetails = null;
                }
            }
            
            drawNewCommitNodes(nodes, nodePositions) {
                if (!this.nodesContainer) return;
                
                nodes.forEach((node, index) => {
                    // Skip if this node already exists
                    if (this.nodeElements.has(node.id)) {
                        return;
                    }
                    
                    // Skip branch listing nodes (git branch without arguments)
                    if (node.type === 'branch' && !node.data.branch) {
                        return;
                    }
                    
                    // Allow switch nodes to be visible now
                    // if (node.type === 'switch') {
                    //     return;
                    // }
                    
                    const pos = nodePositions.get(node.id);
                    if (!pos) return;
                    
                    const nodeElement = this.createCommitNode(node, pos);
                    this.nodesContainer.appendChild(nodeElement);
                    this.nodeElements.set(node.id, nodeElement);
                    
                    // Animate node appearance with staggered delay for chronological effect
                    const delay = index * 100; // 100ms delay between each node
                    this.animateNodeAppearance(nodeElement, delay);
                });
            }
            
            drawCommitNodes(nodes, nodePositions) {
                // Keep this method for backward compatibility, but use drawNewCommitNodes for incremental rendering
                this.drawNewCommitNodes(nodes, nodePositions);
            }
            
            createCommitNode(node, position) {
                const nodeDiv = document.createElement('div');
                nodeDiv.className = `state-node ${node.type}`;
                nodeDiv.style.cssText = `
                    position: absolute;
                    left: ${position.x}px;
                    top: ${position.y}px;
                    width: 80px;
                    height: 40px;
                    background: ${this.getStateColor(node.type)};
                    border: 2px solid #333;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    transform: translate(-50%, -50%);
                    z-index: 10;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 10px;
                    font-weight: bold;
                    color: white;
                    font-family: monospace;
                    border-radius: 5px;
                `;
                
                // Show state instead of command
                let stateText = this.getStateText(node);
                nodeDiv.textContent = stateText;
                
                // Add tooltip with detailed information
                nodeDiv.title = this.getStateTooltip(node);
                
                // Add hover effects
                nodeDiv.addEventListener('mouseenter', () => {
                    nodeDiv.style.transform = 'translate(-50%, -50%) scale(1.1)';
                    nodeDiv.style.zIndex = '20';
                    nodeDiv.style.borderColor = '#000';
                    nodeDiv.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';
                });
                
                nodeDiv.addEventListener('mouseleave', () => {
                    nodeDiv.style.transform = 'translate(-50%, -50%) scale(1)';
                    nodeDiv.style.zIndex = '10';
                    nodeDiv.style.borderColor = '#333';
                    nodeDiv.style.boxShadow = 'none';
                });
                
                // Add click handler for details
                nodeDiv.addEventListener('click', () => {
                    this.showStateDetails(node);
                });
                
                return nodeDiv;
            }
            
            getStateText(node) {
                // Return state based on node type and data
                switch (node.type) {
                    case 'init':
                        return 'REPO INIT';
                    case 'add':
                        return 'FILES STAGED';
                    case 'commit':
                        const hash = node.data.hash ? ` ${node.data.hash.substring(0, 7)}` : '';
                        return `COMMITTED${hash}`;
                    case 'branch':
                        const branchName = node.data.branch || node.data.message || 'new';
                        return `BRANCH: ${branchName}`;
                    case 'switch':
                        return 'SWITCHED';
                    case 'merge':
                        return 'MERGED';
                    case 'push':
                        return 'PUSHED';
                    case 'pull':
                        return 'PULLED';
                    case 'clone':
                        return 'CLONED';
                    default:
                        return node.type.toUpperCase();
                }
            }
            
            getStateColor(type) {
                // Colors for different states
                const colors = {
                    'init': '#2ecc71',
                    'add': '#f39c12',
                    'commit': '#3498db',
                    'branch': '#9b59b6',
                    'switch': '#e67e22',
                    'merge': '#e74c3c',
                    'push': '#16a085',
                    'pull': '#27ae60',
                    'clone': '#2ecc71'
                };
                return colors[type] || '#95a5a6';
            }
            
            getStateTooltip(node) {
                let tooltip = `State: ${this.getStateText(node)}\n`;
                if (node.branch) tooltip += `Branch: ${node.branch}\n`;
                if (node.data.command) tooltip += `Command: ${node.data.command}\n`;
                if (node.data.message) tooltip += `Message: ${node.data.message}\n`;
                if (node.data.hash) tooltip += `Hash: ${node.data.hash}\n`;
                tooltip += `Time: ${new Date(node.timestamp).toLocaleString()}`;
                return tooltip;
            }
            
            showStateDetails(node) {
                const details = [
                    `=== STATE: ${this.getStateText(node)} ===`,
                    `Branch: ${node.branch}`,
                    `Command: ${node.data.command || 'N/A'}`,
                    `Message: ${node.data.message || 'No message'}`,
                    `Time: ${new Date(node.timestamp).toLocaleString()}`
                ];
                
                if (node.data.hash) {
                    details.push(`Hash: ${node.data.hash}`);
                }
                
                if (window.gitProcessor) {
                    details.forEach(detail => {
                        window.gitProcessor.addTerminalOutput(detail, 'info');
                    });
                }
                
                // Highlight the node temporarily
                this.highlightNode(node.id);
            }
            
            getNodeColor(type) {
                const colors = {
                    'init': 'linear-gradient(135deg, #4CAF50, #45a049)',
                    'commit': 'linear-gradient(135deg, #ff6b6b, #ff5252)',
                    'branch': 'linear-gradient(135deg, #54a0ff, #2e86de)',
                    'merge': 'linear-gradient(135deg, #ff9ff3, #ee5a6f)',
                    'push': 'linear-gradient(135deg, #feca57, #ff9ff3)',
                    'pull': 'linear-gradient(135deg, #48dbfb, #0abde3)',
                    'clone': 'linear-gradient(135deg, #1dd1a1, #10ac84)',
                    'switch': 'linear-gradient(135deg, #a55eea, #8854d0)'
                };
                return colors[type] || 'linear-gradient(135deg, #636e72, #2d3436)';
            }
            
            getNodeIcon(type) {
                const icons = {
                    'init': 'üÜï',
                    'commit': 'üìù',
                    'branch': 'üåø',
                    'merge': 'üîÄ',
                    'push': '‚¨ÜÔ∏è',
                    'pull': '‚¨áÔ∏è',
                    'clone': 'üì•',
                    'switch': 'üîÑ'
                };
                return icons[type] || 'üìç';
            }
            
            getNodeTooltip(node) {
                const time = new Date(node.timestamp).toLocaleString();
                const hash = node.data.hash ? ` (${node.data.hash.substring(0, 7)})` : '';
                return `${node.type.toUpperCase()}${hash}\n${node.data.message || 'No message'}\nBranch: ${node.branch}\n${time}`;
            }
            
            animateNodeAppearance(nodeElement, delay = 0) {
                nodeElement.style.transform = 'translate(-50%, -50%) scale(0)';
                nodeElement.style.opacity = '0';
                
                setTimeout(() => {
                    nodeElement.style.transition = 'all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                    nodeElement.style.transform = 'translate(-50%, -50%) scale(1)';
                    nodeElement.style.opacity = '1';
                }, delay);
            }
            
            drawHeadIndicator(nodes, nodePositions) {
                // First, remove any existing HEAD indicators
                this.removeExistingHeadIndicators();
                
                // Find the node that has the HEAD flag (radio button behavior)
                const headNode = nodes.find(node => node.is_head);
                if (!headNode) {
                    // If no HEAD found, try to get it from timeline
                    const timelineHeadNode = window.gitProcessor ? window.gitProcessor.timeline.getHeadNode() : null;
                    if (!timelineHeadNode) {
                        console.log('No HEAD node found in timeline');
                        return;
                    }
                    
                    const headPos = nodePositions.get(timelineHeadNode.id);
                    if (!headPos) return;
                    
                    // Only show HEAD indicator for COMMIT nodes (Git HEAD rule)
                    if (timelineHeadNode.type === 'commit') {
                        this.createHeadIndicatorElement(headPos, timelineHeadNode);
                    } else {
                        console.log('HEAD is not on a commit node, not showing indicator (type:', timelineHeadNode.type, ')');
                    }
                    return;
                }
                
                const headPos = nodePositions.get(headNode.id);
                if (!headPos) return;
                
                // Only show HEAD indicator for COMMIT nodes (Git HEAD rule)
                if (headNode.type === 'commit') {
                    this.createHeadIndicatorElement(headPos, headNode);
                } else {
                    console.log('HEAD is not on a commit node, not showing indicator (type:', headNode.type, ')');
                }
            }
            
            createHeadIndicatorElement(headPos, headNode) {
                // Don't check for errors when showing HEAD - HEAD should always be visible
                // regardless of command errors
                
                // Only don't show HEAD if there are no valid nodes
                if (this.nodeElements.size === 0) {
                    return;
                }
                
                // Get the DOM element for the HEAD node
                const headNodeElement = this.nodeElements.get(headNode.id);
                if (!headNodeElement) {
                    console.log('HEAD node element not found:', headNode.id);
                    return;
                }
                
                // Create HEAD indicator above the node
                const headIndicator = document.createElement('div');
                headIndicator.className = 'head-indicator'; // Add class for easy removal
                headIndicator.style.cssText = `
                    position: absolute;
                    left: ${headPos.x}px;
                    top: ${headPos.y - 35}px;
                    background: #FFD700;
                    color: #333;
                    padding: 4px 8px;
                    border-radius: 12px;
                    font-size: 10px;
                    font-weight: bold;
                    z-index: 1000;
                    transform: translateX(-50%);
                    box-shadow: 0 2px 8px rgba(255, 215, 0, 0.5);
                    animation: pulse 2s infinite;
                    font-family: monospace;
                    pointer-events: none;
                `;
                headIndicator.textContent = 'HEAD';
                
                this.nodesContainer.appendChild(headIndicator);
                console.log('HEAD indicator created for node:', headNode.id, 'type:', headNode.type);
            }
            
            removeExistingHeadIndicators() {
                // Remove all existing HEAD indicators
                const existingIndicators = this.nodesContainer.querySelectorAll('.head-indicator');
                existingIndicators.forEach(indicator => indicator.remove());
            }
            
            blinkBranchBeforeDeletion(branchName, callback) {
                // Find the branch line element
                const branchLine = this.svg.querySelector(`[data-branch="${branchName}"]`);
                const branchLabel = this.svg.querySelector(`[data-branch-label="${branchName}"]`);
                
                if (!branchLine) {
                    // If no branch line found, just call callback immediately
                    callback();
                    return;
                }
                
                let blinkCount = 0;
                const maxBlinks = 5;
                const blinkDuration = 1000; // 1 second per blink
                
                const blink = () => {
                    if (blinkCount >= maxBlinks) {
                        // Restore original style and call callback
                        branchLine.style.opacity = '0.2';
                        branchLine.style.filter = 'none';
                        if (branchLabel) {
                            branchLabel.style.fill = '#999';
                            branchLabel.style.filter = 'none';
                        }
                        callback();
                        return;
                    }
                    
                    // Toggle visibility
                    if (blinkCount % 2 === 0) {
                        // Show (highlight)
                        branchLine.style.opacity = '1';
                        branchLine.style.filter = `drop-shadow(0 0 10px #ff0000)`;
                        if (branchLabel) {
                            branchLabel.style.fill = '#ff0000';
                            branchLabel.style.filter = `drop-shadow(0 0 10px #ff0000)`;
                        }
                    } else {
                        // Hide (fade)
                        branchLine.style.opacity = '0.1';
                        branchLine.style.filter = 'none';
                        if (branchLabel) {
                            branchLabel.style.fill = '#ccc';
                            branchLabel.style.filter = 'none';
                        }
                    }
                    
                    blinkCount++;
                    setTimeout(blink, blinkDuration);
                };
                
                // Start blinking
                blink();
            }
            
            showNodeDetails(node) {
                const details = [
                    `=== ${node.type.toUpperCase()} NODE ===`,
                    `Command: ${node.data.command || 'N/A'}`,
                    `Message: ${node.data.message || 'No message'}`,
                    `Branch: ${node.branch}`,
                    `Time: ${new Date(node.timestamp).toLocaleString()}`
                ];
                
                if (node.data.hash) {
                    details.push(`Hash: ${node.data.hash}`);
                }
                
                if (window.gitProcessor) {
                    details.forEach(detail => {
                        window.gitProcessor.addTerminalOutput(detail, 'info');
                    });
                }
                
                // Highlight the node temporarily
                this.highlightNode(node.id);
            }
            
            showEdgeDetails(edge) {
                const details = [
                    `=== EDGE CONNECTION ===`,
                    `Command: ${edge.command || 'Connection'}`,
                    `From: ${edge.from}`,
                    `To: ${edge.to}`,
                    `Type: ${edge.data.type || 'standard'}`
                ];
                
                if (window.gitProcessor) {
                    details.forEach(detail => {
                        window.gitProcessor.addTerminalOutput(detail, 'info');
                    });
                }
                
                // Highlight the edge temporarily
                this.highlightEdge(edge.id);
            }
            
            highlightNode(nodeId) {
                const nodeElement = this.nodeElements.get(nodeId);
                if (nodeElement) {
                    const originalBorder = nodeElement.style.borderColor;
                    const originalTransform = nodeElement.style.transform;
                    
                    nodeElement.style.borderColor = '#ff0000';
                    nodeElement.style.transform = 'translate(-50%, -50%) scale(1.3)';
                    nodeElement.style.zIndex = '30';
                    
                    setTimeout(() => {
                        nodeElement.style.borderColor = originalBorder;
                        nodeElement.style.transform = originalTransform;
                        nodeElement.style.zIndex = '10';
                    }, 2000);
                }
            }
            
            highlightEdge(edgeId) {
                const edgeElement = this.edgeElements.get(edgeId);
                if (edgeElement) {
                    const originalStroke = edgeElement.getAttribute('stroke');
                    const originalWidth = edgeElement.getAttribute('stroke-width');
                    const originalOpacity = edgeElement.getAttribute('opacity');
                    
                    edgeElement.setAttribute('stroke', '#ff0000');
                    edgeElement.setAttribute('stroke-width', parseInt(originalWidth) + 2);
                    edgeElement.setAttribute('opacity', '1');
                    
                    setTimeout(() => {
                        edgeElement.setAttribute('stroke', originalStroke);
                        edgeElement.setAttribute('stroke-width', originalWidth);
                        edgeElement.setAttribute('opacity', originalOpacity);
                    }, 2000);
                }
            }
            
            highlightConnectedEdges(nodeId, highlight) {
                // Find and highlight edges connected to this node
                this.edgeElements.forEach((edgeElement, edgeId) => {
                    const edge = this.findEdgeById(edgeId);
                    if (edge && (edge.from === nodeId || edge.to === nodeId)) {
                        if (highlight) {
                            edgeElement.setAttribute('opacity', '1');
                            edgeElement.setAttribute('stroke-width', parseInt(edgeElement.getAttribute('stroke-width')) + 1);
                        } else {
                            edgeElement.setAttribute('opacity', '0.7');
                            edgeElement.setAttribute('stroke-width', parseInt(edgeElement.getAttribute('stroke-width')) - 1);
                        }
                    }
                });
            }
            
            findEdgeById(edgeId) {
                // This would need access to timeline data - simplified version
                return { from: '', to: '' }; // Placeholder
            }
            
            focusOnNode(nodeId) {
                const nodeElement = this.nodeElements.get(nodeId);
                if (nodeElement) {
                    // Center the view on this node
                    const nodeRect = nodeElement.getBoundingClientRect();
                    const containerRect = this.timelineContainer.getBoundingClientRect();
                    
                    // Calculate pan to center node
                    const targetX = containerRect.width / 2 - (nodeRect.left + nodeRect.width / 2) + containerRect.left;
                    const targetY = containerRect.height / 2 - (nodeRect.top + nodeRect.height / 2) + containerRect.top;
                    
                    // Smooth pan to node
                    this.panX = targetX;
                    this.panY = targetY;
                    this.updateTransform();
                    
                    // Highlight the node
                    this.highlightNode(nodeId);
                }
            }
        }
        
        // Initialize Git graph visualizer
        const gitGraphVisualizer = new GitGraphVisualizer();
        
        // Show empty state by default on page load
        gitGraphVisualizer.showEmptyState();
        
        function renderGitGraph(timelineData) {
            console.log('renderGitGraph called with timelineData:', timelineData);
            console.log('Nodes in timeline:', timelineData.nodes.map(n => ({id: n.id, type: n.type, branch: n.branch})));
            gitGraphVisualizer.render(timelineData);
        }
        
        function addTimelineInteractivity() {
            const commandNodes = document.querySelectorAll('.command-node');
            const branchVisualizer = document.getElementById('branch-visualizer');
            
            // Zoom and pan state
            let zoom = 1;
            let panX = 0;
            let panY = 0;
            let isDragging = false;
            let dragStartX = 0;
            let dragStartY = 0;
            
            // Add hover effects to command nodes
            commandNodes.forEach(node => {
                node.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.1)';
                    this.style.zIndex = '100';
                    this.querySelector('.command-info').style.opacity = '1';
                    this.querySelector('.command-info').style.transform = 'translateY(-10px)';
                });
                
                node.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1)';
                    this.style.zIndex = '';
                    this.querySelector('.command-info').style.opacity = '0.9';
                    this.querySelector('.command-info').style.transform = 'translateY(0)';
                });
                
                // Add click interaction
                node.addEventListener('click', function() {
                    const nodeId = this.dataset.nodeId;
                    const command = this.dataset.command;
                    const message = this.dataset.message;
                    const type = this.dataset.type;
                    
                    // Show command details in terminal
                    if (window.gitProcessor) {
                        window.gitProcessor.addTerminalOutput(`\n=== Command Details ===`, 'info');
                        window.gitProcessor.addTerminalOutput(`Type: ${type.toUpperCase()}`, 'info');
                        window.gitProcessor.addTerminalOutput(`Command: ${command}`, 'info');
                        window.gitProcessor.addTerminalOutput(`Message: ${message}`, 'info');
                        
                        // Add specific details for commit nodes
                        if (type === 'commit') {
                            const hash = this.querySelector('.commit-hash').textContent.replace(' üìç', '');
                            window.gitProcessor.addTerminalOutput(`Hash: ${hash}`, 'info');
                        }
                        
                        window.gitProcessor.addTerminalOutput(`====================\n`, 'info');
                    }
                    
                    // Highlight selected node
                    document.querySelectorAll('.command-node').forEach(n => n.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
            
            // Add zoom and pan to SVG
            branchVisualizer.addEventListener('wheel', function(e) {
                e.preventDefault();
                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                zoom *= delta;
                zoom = Math.min(Math.max(zoom, 0.5), 3);
                updateTransform();
            });
            
            branchVisualizer.addEventListener('mousedown', function(e) {
                isDragging = true;
                dragStartX = e.clientX - panX;
                dragStartY = e.clientY - panY;
                this.style.cursor = 'grabbing';
            });
            
            document.addEventListener('mousemove', function(e) {
                if (isDragging) {
                    panX = e.clientX - dragStartX;
                    panY = e.clientY - dragStartY;
                    updateTransform();
                }
            });
            
            document.addEventListener('mouseup', function() {
                isDragging = false;
                branchVisualizer.style.cursor = 'grab';
            });
            
            function updateTransform() {
                branchVisualizer.style.transform = `translate(${panX}px, ${panY}px) scale(${zoom})`;
                document.getElementById('commit-nodes').style.transform = `translate(${panX}px, ${panY}px) scale(${zoom})`;
            }
            
            // Set initial cursor
            branchVisualizer.style.cursor = 'grab';
        }
        
        function updateStorageAreas() {
            if (!window.gitProcessor) return;
            
            const timeline = window.gitProcessor.timeline;
            const currentBranch = timeline.getCurrentBranch() || 'main';
            
            // Get files from different stages based on timeline
            const workingFiles = getWorkingDirectoryFiles();
            const stagedFiles = getStagedFiles();
            const committedFiles = getCommittedFiles();
            const remoteFiles = getRemoteFiles();
            
            // Update Working Directory
            updateStage('working-files', workingFiles);
            
            // Update Staging Area
            updateStage('staged-files', stagedFiles);
            
            // Update Local Repository
            updateStage('committed-files', committedFiles);
            
            // Update Remote Repository
            updateStage('remote-files', remoteFiles);
            
            // Update file counts
            updateFileCount('stage-working', workingFiles.length);
            updateFileCount('stage-staging', stagedFiles.length);
            updateFileCount('stage-local', committedFiles.length);
            updateFileCount('stage-remote', remoteFiles.length);
        }
        
        function getWorkingDirectoryFiles() {
            // Get all files from local directory (files always stay here)
            const localFiles = window.gitProcessor.getLocalFiles() || ['index.html', 'style.css', 'script.js'];
            
            // Return files with status indicators
            return localFiles.map(file => {
                const stagedFiles = window.gitProcessor.sessionData.stagedFiles || [];
                const isStaged = stagedFiles.includes(file);
                
                return {
                    name: file,
                    status: isStaged ? 'staged' : 'modified',
                    isStaged: isStaged
                };
            });
        }
        
        function getStagedFiles() {
            // Get files from staging area
            const stagedFiles = window.gitProcessor.sessionData.stagedFiles || [];
            
            return stagedFiles.map(file => ({
                name: file,
                status: 'staged'
            }));
        }
        
        function getCommittedFiles() {
            // Get files from commit nodes and session committed files
            const commits = window.gitProcessor.timeline.getCommits();
            const files = [];
            
            // Add files from commits
            commits.forEach(commit => {
                if (commit.data.message && commit.data.message !== 'Commit') {
                    files.push({
                        name: `commit-${commit.id.slice(-6)}.txt`,
                        message: commit.data.message,
                        author: commit.data.author,
                        timestamp: commit.timestamp,
                        files: commit.data.files || []
                    });
                }
            });
            
            return files;
        }
        
        function getRemoteFiles() {
            // Get files that have been pushed
            const pushNodes = Array.from(window.gitProcessor.timeline.nodes.values())
                .filter(node => node.type === 'push');
            
            if (pushNodes.length > 0) {
                return getCommittedFiles(); // Files that were pushed
            }
            
            return [];
        }
        
        function updateStage(stageId, files) {
            const stageElement = document.getElementById(stageId);
            if (!stageElement) return;
            
            stageElement.innerHTML = '';
            
            if (files.length === 0) {
                stageElement.innerHTML = '<li class="empty-stage">No files</li>';
                return;
            }
            
            files.forEach(file => {
                const li = document.createElement('li');
                li.className = 'file-item';
                
                // Add status indicator for working directory
                let statusIcon = '<i class="fas fa-file"></i>';
                let statusClass = '';
                
                if (file.isStaged !== undefined) {
                    if (file.isStaged) {
                        statusIcon = '<i class="fas fa-check-circle" style="color: #4CAF50;"></i>';
                        statusClass = 'staged';
                    } else {
                        statusIcon = '<i class="fas fa-edit" style="color: #FF9800;"></i>';
                        statusClass = 'modified';
                    }
                }
                
                if (typeof file === 'string') {
                    li.innerHTML = `
                        ${statusIcon}
                        <span class="file-name ${statusClass}">${file}</span>
                    `;
                } else {
                    const escapedMessage = (file.message || '').replace(/"/g, '&quot;').replace(/'/g, '&#39;');
                    const escapedAuthor = (file.author || '').replace(/"/g, '&quot;').replace(/'/g, '&#39;');
                    const escapedName = (file.name || '').replace(/"/g, '&quot;').replace(/'/g, '&#39;');
                    
                    li.innerHTML = `
                        ${statusIcon}
                        <span class="file-name ${statusClass}">${escapedName}</span>
                        ${file.message ? `<span class="file-message">${escapedMessage}</span>` : ''}
                        ${file.author ? `<span class="file-author">${escapedAuthor}</span>` : ''}
                        ${file.files && file.files.length > 0 ? `<span class="file-count-mini">${file.files.length} files</span>` : ''}
                    `;
                }
                
                stageElement.appendChild(li);
            });
        }
        
        function updateFileCount(stageId, count) {
            const stageElement = document.getElementById(stageId);
            if (!stageElement) return;
            
            const countElement = stageElement.querySelector('.file-count');
            if (countElement) {
                countElement.textContent = count;
            }
        }
        
        function toggleTerminal() {
            const terminal = document.getElementById('terminal');
            const toggleBtn = document.querySelector('.terminal-toggle');
            
            if (terminal.classList.contains('expanded')) {
                // If expanded, go to normal state
                terminal.classList.remove('expanded');
                terminal.classList.add('minimized');
                toggleBtn.innerHTML = '<i class="fas fa-terminal"></i> Terminal';
            } else if (terminal.classList.contains('minimized')) {
                // If minimized, go to normal state
                terminal.classList.remove('minimized');
                toggleBtn.innerHTML = '<i class="fas fa-expand"></i> Expand';
            } else {
                // If normal, go to expanded state
                terminal.classList.add('expanded');
                toggleBtn.innerHTML = '<i class="fas fa-compress"></i> Minimize';
            }
        }
        
        function clearTerminal() {
            if (window.gitProcessor) {
                window.gitProcessor.clearTerminalOutput();
                updateTerminal();
            }
        }
        
        // Graph control functions
        function zoomIn() {
            if (gitGraphVisualizer) {
                gitGraphVisualizer.setZoom(gitGraphVisualizer.zoom * 1.2);
            }
        }
        
        function zoomOut() {
            if (gitGraphVisualizer) {
                gitGraphVisualizer.setZoom(gitGraphVisualizer.zoom * 0.8);
            }
        }
        
        function resetZoom() {
            if (gitGraphVisualizer) {
                gitGraphVisualizer.resetView();
            }
        }
        
        function centerGraph() {
            if (gitGraphVisualizer) {
                gitGraphVisualizer.centerView();
            }
        }
        
        function updateGitStatusDisplay() {
            const currentBranchElement = document.getElementById('current-branch');
            const commitCountElement = document.getElementById('commit-count');
            
            if (!currentBranchElement || !commitCountElement) return;
            
            // Check if repository exists
            if (!window.gitProcessor || !window.gitProcessor.hasGitRepository()) {
                currentBranchElement.textContent = 'No repository';
                commitCountElement.textContent = '';
                return;
            }
            
            // Get current branch and commit count
            const currentBranch = window.gitProcessor.timeline.getCurrentBranch() || 'main';
            const commitCount = Array.from(window.gitProcessor.timeline.nodes.values())
                .filter(node => node.type === 'commit').length;
            
            currentBranchElement.textContent = currentBranch;
            commitCountElement.textContent = commitCount > 0 ? `${commitCount} commits` : '0 commits';
        }
        
        function updateBranchIndex() {
            const branchIndexContent = document.getElementById('branch-index-content');
            if (!branchIndexContent) {
                console.log('Branch index content element not found');
                return;
            }
            
            if (!window.gitProcessor || !window.gitProcessor.hasGitRepository()) {
                branchIndexContent.innerHTML = '<div style="color: #999;">No repository</div>';
                console.log('No repository found for branch index');
                return;
            }
            
            const branches = Array.from(window.gitProcessor.timeline.branches.entries());
            const currentBranch = window.gitProcessor.timeline.getCurrentBranch() || 'main';
            const branchColors = {
                'main': '#4CAF50',
                'master': '#4CAF50',
                'develop': '#FF9800',
                'design_codes': '#2196F3',
                'logic_codes': '#9C27B0',
                'database_schema': '#FF5722',
                'ui_components': '#00BCD4',
                'api_endpoints': '#FF9800',
                'testing_suite': '#4CAF50',
                'documentation': '#795548',
                'deployment': '#F44336',
                'bugfix': '#F44336',
                'hotfix': '#F44336',
                'release': '#9C27B0'
            };
            
            console.log('Updating branch index with branches:', branches);
            console.log('Current branch:', currentBranch);
            
            let html = '';
            branches.forEach(([branchName, nodeId], index) => {
                const color = branchColors[branchName] || '#666';
                const isCurrentBranch = branchName === currentBranch;
                
                html += `
                    <div class="branch-item ${isCurrentBranch ? 'current-branch' : ''}">
                        <div class="branch-index-number">${index + 1}</div>
                        <div class="branch-color-box" style="background-color: ${color}; border-color: ${color};"></div>
                        <div class="branch-name">${branchName}</div>
                    </div>
                `;
            });
            
            branchIndexContent.innerHTML = html;
            console.log('Branch index updated with HTML:', html);
        }
    </script>
</body>
</html>